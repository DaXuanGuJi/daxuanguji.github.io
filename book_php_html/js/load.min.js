try {
	var ptset = localStorage.ptset ? JSON.parse(localStorage.ptset) : 0;
	ptset && (saveobj.value = "\ud83d\udcb9", saveobj.style.color = "#00f")
} catch (a) {
	ptset = 0
}
var bookTypeBrcode = {
	DXGJ_M_ : 1001,
	DXGJ_X_ : 9001,
	DXGJ_F_ : 8001,
	DXGJ_W_ : 5001,
	DXGJ_Z_ : 7001
}, bjfc = {
	R : ["#FF0000FF", "#00000000"],
	O : ["#FF7F00FF", "#000000FF"],
	Y : ["#FFFF00FF", "#000000FF"],
	G : ["#00FF00FF", "#000000FF"],
	L : ["#00FFFFFF", "#000000FF"],
	B : ["#0000FFFF", "#000000FF"],
	P : ["#FF00FFFF", "#000000FF"],
	J : ["#CD7F32FF", "#FF0000FF"],
	E : ["#C0C0C0FF", "#000000FF"],
	T : ["#B87333FF", "#000000FF"],
	C : ["#787878FF", "#000000FF"],
	H : ["#000000FF", "#FF0000FF"],
	W : ["#FFFFFFFF", "#000000FF"],
	Z : ["#BC1717FF", "#000000FF"],
	N : ["#871F78FF", "#000000FF"],
	S : ["#0000FFFF", "#FFFFFFFF"]
};
fontlist = {
	kaiT : ["Kai-01,Kai-02,Kai-03", 140],
	songT : ["song-01,song-02", 150],
	mingT : ["HanaMinA,HanaMinB", 150],
	WsongT : ["SimSun-01,SimSun-02", 150],
	SYHeiT : ["SY-HeiT", 154],
	SYHeiNT : ["SY-HeiNT", 154],
	SYSongT : ["SY-SongT", 154],
	GLT4 : ["GLT4", 136],
	QJT4 : ["QJT4", 120],
	GLT3 : ["GLT3", 136],
	QJT3 : ["QJT3", 120],
	XYZT : ["XYZT", 148],
	XZJT : ["XZJT", 148],
	SKQS : ["'TypeLand \u5eb7\u7199\u5b57\u5178\u9ad4'", 148],
	HZPY : ["Pinyin", 190],
	FTHZPY : ["ToneOZ-Pinyin-Kai-Traditional", 224],
	XFKJZT : ["XFKJZT,Segoe UI Emoji", 224]
};
var fex = 0, txtReg = /[\ud840-\ud888]*[0-9xX\u3400-\uFAD9]/;
ptset || (ptset={	
	bookpath:"book/",//指定封面字体图片目录
	backpath:"back/",//指定封面背景图片目录	
	bodypath:"body/",//指定页面字体图片目录
	fontspath:"font/",//指定字体图片目录
	fontpath:"kaiT/",//指定字体图片目录下默认字体图片目录
	infopath:"info/",//指定页面字体特殊《…＜字符图片目录
	infoimage:"$@ []=()!&^ˇ¦·，。；？！、”“‘’》《＞＜▁▂▃▄▅▆▇█▉▊▋▌▍▎▏↓→~…︙┋┉—〔〕%⚫⬛▼◆❖№㊣ΘΞ℉⊕・◦",//指定页面特殊字符infopath指定目录下包含的有效图片名称
	//【强制纵向换行符$,强制纵向双行第二行换行符@,空白字符 图片为null.png,单双行开始字符[,单双行结束字符],强制横向换行符=,右下角标字符(,左下角标字符),下移字符!,上移字符^,标点符号，。；？！、”“》＞，空格横纵方向各8个8分▁▂▃▄▅▆▇█▉▊▋▌▍▎▏，横纵方向两个空格↓→，半高位~,字体切换&,目录索引№,原文注释ΘΞ【字列行数修改℉需要在文本开始处中文字符前匹配一般跟在翻页符*后面】""】⊕高度32分之几用在排版上   ・◦隐藏式逗句号。排版文档不想要标点朗读时无法断句用此作逗句号
	nowhimage:"$@=()!^~%&№℉⊕・◦",//指定页面字体图片高度为0的字体图片
	backcolor:"#344665FF",//指定底层默认背景颜色
	backimage:["xs","back18.jpg"],//指定底层默认背景图片[样式《默认xy平铺｜n不平铺|x平铺|y平铺｜s缩放|支持"[xyn][spxyn|s与前面相同|p全页面长宽|x以指定高度缩放x平铺|y以指定宽度缩放y平铺|n以指定高度宽度缩放不平铺·详见getimgcv函数]比例canvas"》],封面默认背景颜色】"
	setheight:1,//设置界面缩放高度
	setback:2,//设置自动备份1为自动备份 2为自动加载,3为共同选择
	imgtype:["png",1],//导出格式png jpg，压缩比0-1
	debugdpi:36,//指定调试时dpi大小，加快预览
	bookobj:{
		page:"A4",//书本封面页面大小
		height:[6,1],//【书本封面为双页面时的中间厚度,是否开启双页面标记《1为开启|0为关闭》】 
		fengx:20,//缝线宽度
		dpi:0,//指定封面dpi大小《0为默认电脑浏览器dpi为96;打印图片应最低300dpi才清晰》
		font:{
			name:["bold 120px "+fontlist.kaiT[0],[2,86,180,120],["#000"],0],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
			author:["bold 20px "+fontlist.kaiT[0],[2,14,180,140],["#f00","#0f0","#00f","#f00","#f00","#f00"],0],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页直
			copyright:["bold 30px "+fontlist.kaiT[0],[2,20,220,140],["#f06","#f00","#0ff","#f00","#f06","#0ff"],0],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页直
			htxt:["bold 40px "+fontlist.kaiT[0],[2,40,180,110],["#60f","#f00","#00f","#50f","#f00","#00f"],1],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
			midname:["bold 20px "+fontlist.kaiT[0],[0,14,180,140],["#f00","#0f0","#00f","#f00","#f0f","#f0f","#f00"],0],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页直
			tfontw:[1,"一二三",[80,126,128]],//tfont一些字体间距太大重定义高度1开启0关闭,文字，高度，距顶
			cealcopy:["bold 50px "+fontlist.kaiT[0],[2,20,220,140],["#fff"],0],//字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页直
		},
		setmode:1,//1为左封面 0为右封面
		modeflg:"l",//lmr为左封面左中右 LRM为右封面左中右

		bk3d:"6,6,#ffffffff,1,20",//3d封面宽，高，页面颜色，封面外皮厚度。图片留白
		bkpic:[[0,0,0,0,0,0,0,0],["xs",""],""],//封面背景图片大小位置,封面背景图片文件及样式,封面默认背景颜色	
		//【封面图片大小位置[原图裁剪x,原图裁剪y,原图裁剪w,原图裁剪h,画布显示x,画布显示y,画布显示w,画布显示],封面图片文件及样式[样式《默认xy平铺｜n不平铺|x平铺|y平铺｜s缩放|支持"[xyn][spxyn|s与前面相同|p全页面长宽|x以指定高度缩放x平铺|y以指定宽度缩放y平铺|n以指定高度宽度缩放不平铺·详见getimgcv函数]比例canvas"》],封面默认背景颜色】
		tbr:["$","="],	//指定封面字体图片纵向换行分列符,横向换行符分行符
		loads:{//封面默认加载图形及背景颜色《可自行按样式添加;不影响使用》
			box:{//向封面添加一个方形box
				//【box在页面上大小位置[x,y,w,h]《相对位置为"X"全页面宽，"x"半页面宽，"H"全页面高，"h"半页面高，"T"全厚度，"t"半厚度，"d[0-3]"当前的x,y,w,h》,box背景颜色,box背景图片】
				namebox:[[36,30,42,170],"",["xp","back202.jpg"]],
				//namebox:[[36,30,42,180],"",["s","bk7.png"]],
				authorbox:[[36,154,42,16],"",["",""]],
				//authorbox:[[36,154,42,16],"",["",""]],
				datebox:[["W-d[2]","H-d[3]",10,40],"#fff",["",""]],			
				copyrightbox:[["X+fex/2","H-d[3]","x-fex/2",40],"",["s","bg1.png"]],
				midnamebox:[["x",0.2,"T","H/7"],"",["",""]],	
				midauthorbox:[["x",0.8,"T","H/7"],"",["",""]],			
				},
			text:{//向box添加text文字图片
			//【text文字图片在box大小位置[左边距,上边距,右边距,下边距,文字横间距,文字纵间距],文字内容,文字图片路径,[文字背景颜色,是否平分间距《1是0否》,对齐方式0左/上1中2右/下],是否横向《1是0否》,[文字前景色,文字背景色]】,调用字体名bookobj.font
			//文字路径可为空是默认fontpath
				//name:[[2,2,2,46,2,2],"不知所言","name/",["#fff",1,1],false,["",""],"name"],
				name:[[2,2,2,46,2,2],"周易","",["#fff",1,1],false,["","",4],"name"],
				//name:[[3,8,6,56,2,2],"不知所言","name/",["",1,1],false,["",""],"name"],
				author:[[1,1,1,1,0,2],"西周=周文王姬昌","",["#0f0",0,1],true,["","",4],"author"],	
				date:[[0,0,0,0,2,0],"2023","data/5/",["#fff",1,0],false,["","",4]],	
				copyright:[[10,1,60,1,-2,2],"玄之又玄 謂之大玄=學海無涯君作岸=書山絕頂吾为峰=大玄古籍書店獨家出版","",["",0,1],true,["","",4],"copyright"],	
				midname:[[0,0,0,0,0,0],"","",["#fff",1,1],false,["","",4],"midname"],	
				midauthor:[[0,0,0,0,0,0],"","",["#fff",1,1],false,["","",4],"midname"],		
			}	
		},		
//向封面添加一个方形box
//【box在页面上大小位置[x,y,w,h]《相对位置为"W"全页面宽，"w"半页面宽，"X"半页面宽无厚度，"x"半页面宽+厚度，"H"全页面高，"h"半页面高，"T"全厚度，"t"半厚度f前缝线F后缝线，"d[0-3]"当前的x,y,w,h》,box背景颜色,box背景图片】
		box:{	
			//cealbox:[[43,170,28,28],"",["s","ceal.png"]],
			cealbox:[[43,170,28,28],"",["s","ceal.png"]],
			qrbox:[[-10,"H-d[3]",40,40],"",["s",""]],
			brbox:[["X+fex/2",-40,100,40],"",["s",""]],
			imagebox0:[["x-fex/2",0,"T+fex","H"],"#ffffff00",["",""]],	//中间全纯色封线块	
			imagebox01:[["w-3",0,6,"H"],"#ffffff00",["",""]],//缝线分割线		
			imagebox4:[["x-fex/2",0.125,"T+fex",1.5],"#fff",["",""]],
			imagebox5:[["x-fex/2",0.275,"T+fex",1.5],"#fff",["",""]],		
			imagebox6:[["x-fex/2",0.425,"T+fex",1.5],"#fff",["",""]],
			imagebox7:[["x-fex/2",0.575,"T+fex",1.5],"#fff",["",""]],
			imagebox8:[["x-fex/2",0.725,"T+fex",1.5],"#fff",["",""]],
			imagebox9:[["x-fex/2",0.875,"T+fex",1.5],"#fff",["",""]],
			imagebox3:[["x-fex/2",0,1.5,"H"],"#fff",["",""]],//竖封线
			imagebox2:[["X-1.5+fex/2",0,1.5,"H"],"#fff",["",""]],//竖封线		
			imagebox1:[["X+fex/2",-41,"x",0.5],"#f00",["",""]],	//版权分割线“红色分隔线
			cealcopyboxL:[["x-fex/2-40",0,40,50],"",["s",""]],
			cealcopyboxM:[["x-fex/2",0,"T+fex",50],"",["s",""]],
			cealcopyboxR:[["X+fex/2",0,40,50],"",["s",""]],
		},
//向封面添加text文字图片
//【text文字图片在box大小位置[左边距,上边距,右边距,下边距,文字横间距,文字纵间距],文字内容,文字图片路径,[文字BOX框背景颜色,是否平分间距《1是0否》,对齐方式0左/上1中2右/下],是否横向《1是0否》,[单个文字前景色,单个文字背景色]】	,调用字体名bookobj.font	
		text:{
			//文字路径可为空是默认fontpath
			//wtxt:[["w*0.15 + w",20,"x*0.8","h+20",-10,2],"=天行健  君子以自強不息=地勢坤  君子以厚德載物=隨風巽  君子以申命行事=漸雷震  君子以恐懼修省=善如水  君子以作事謀始=火同人  君子以類族辨物=步澤履  君子以辨民安誌=根山謙  君子以裒多益寡=","name/",["",0,1],true,["","",4]],
			//wtxt2:[[0,-15,"x",10,-10,2],"=大玄古籍書店獨家出版=","htxt/",["",0,1],true,["","",4],"copyright"],
			//htxt2:[["w-fex/2-120","h/3",120,"h",2,2],"天行健 君子以自強不息$地勢坤 君子以厚德載物$隨風巽 君子以申命行事$漸雷震 君子以恐懼修省$善如水 君子以作事謀始$火同人 君子以類族辨物$步澤履 君子以辨民安誌$根山謙 君子以裒多益寡","",["#fff",0,0],false,["#f00","#00f",4],"htxt"],			
			wtxt:[["w*0.15 + w",20,"x*0.8","h+20",-10,2],"","name/",["",0,1],true,["","",4]],
			wtxt2:[[0,-15,"x",10,-10,2],"","htxt/",["",0,1],true,["","",4],"copyright"],
			htxt:[["w*0.2 + w",20,"x*0.7","h/2",2,1],"天行健 君子以自強不息$地勢坤 君子以厚德載物$隨風巽 君子以申命行事$漸雷震 君子以恐懼修省$善如水 君子以作事謀始$火同人 君子以類族辨物$步澤履 君子以辨民安誌$根山謙 君子以裒多益寡","",["",0,0],false,["#ffff","#0000",4],"htxt"],
			htxt2:[["w-fex/2-120","h/3",120,"h",2,2],"","",["",0,0],false,["#f00","#00f",4],"htxt"],			
			versionL:[["w-fex/2-20",8,20,"h",2,2],"","",["",0,0],false,["#f00","#00f",4],"cealcopy"],
			versionR:[["w+fex/2",8,20,"h",2,2],"","",["",0,0],false,["#f00","#00f",4],"cealcopy"],
		}		
	},
	bodyobj:{
		page:"A4",//书本内容页面大小
		pageindex:1,//页面初始序号//双数为右面开始，单数为左封面开始
		pagemerge:1,//页面合并标记//1从后往前翻书
		pagemergeval:[0,1,1],//页面合并参数【生成图片的开始页序号[0或1只与奇偶有关]，拆分后合并生成图片的开始页序号；[0为正常合并只能半页半页读，因为左右同页面开数后会在纸张的正反面，1为全页面。会将页码错开合并，需要对照页码装订],是否弹出对话框确认选择[0否1是]】		
		setmode:1,//0为从右向左列文本 1为从左向右列文本		  
		nullpage:[["*","|"],"#",135,2,1],//翻页字符标记[全页,半页],空页面字符标记(若第一字为#则按样式创建空白页若第一二字都为#则按空白页样式创建当前页文字),空页面样式，1bk,2Tbk,4cel,8txtbk,16txtbox,32picbox,64pageidx,128pagewat,[1右半页面正中显示书名字体样式2左半页面正中显示书名字体样式][1右半页面正中条形码样式2左半页面正中条形码样式]if(!pagepdf[0]&&nlp[3])txt="##*"
		titfont:["bold 150px "+fontlist.kaiT[0],[0,0,180,140],["#000"],0],//空页面标题字体名##*开头页面nullpage[3]设置，左偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
		zeropage:0,//第0页面样式，0空白，1显示边框,2显示字列,4显示页码,8书名标题//需要nullpage第二参数需要数字开启
		zeroonepage:0,//第0页1面样式，0空白，1显示边框,2显示字列,4显示页码,8书名标题//需要nullpage第二参数需要数字开启
		pagespt:[2,[4,36]],//拆分合并书页多少开8，16，32，64.128/自动运算范围0不拆分1只拆分不合并2提示选择开数后拆分后合并3自动选择拆分后合并，4以上为开数拆分后合并
		height:[0,1],//【书本内容页为双页面时的中间厚度,是否开启双页面标记《1为开启|0为关闭》】 
		dpi:0,//指定内容页dpi大小《0为默认电脑浏览器dpi为96;打印图片应最低300dpi才清晰》
		tcn:0,//提取中文选项设置选择项记录
		trand:2,//开启字符随机0本地字符图片1联网随机字符图片2本地字体
		tfont:["bold 54px "+fontlist.kaiT[0],[2,0,180,140],["#03f","#f00","#00f","#f00","#00f","#f00"],0],//文字字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
		pfont:["bold 20px "+fontlist.HZPY[0],[2,0,180,140],["#03f","#f00","#00f","#f00","#00f","#f00"],0],//拼音字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
		wfont:["bold 54px "+fontlist.kaiT[0],[2,0,180,140],["#03f","#f00","#00f","#f00","#00f","#f00"],0],//水印字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页
		bfont:["bold 27px "+fontlist.kaiT[0],[0,0,180,139],["#03f","#f00","#00f","#f00","#00f","#f00"],0],//角标字符。字体名，左偏移，上偏移，宽度，高度，渐变色。渐变方向0上水平1中水平2中垂直4全对角8前半页16后半页32上半页64下半页//算法字体/2,y=-高度/4,高度+-1不能与原高度相等这是角标标志		
		tfontw:[0,"一二三",[80,126,128]],//tfont一些字体间距太大重定义高度1开启0关闭,文字，高度，距顶
		bkpic:[[0,0,0,0,0,0,0,0],["s","page1.jpg"],"#f0f"],//内容页背景图片大小位置,内容页背景图片文件及样式,封面默认背景颜色
		tbr:["$","@",")","(","!","^","~","%","&","№","℉","⊕"],//文字内容强制纵向换行分列第一行标记字符,文字强制纵向换行分列第二行标记字符,文字右下角标标记字符,文字左下角标标记字符,下移标记，上移标记，半页高度标记,反相图片标记[bjfc定义],字体切换标记[&0-&z] 32进制fontTAB定义]字列行数修改℉[℉0-℉q需要在文本开始处中文字符前匹配一般跟在翻页符*后面℉r-℉z可打开关闭【r标点,s页码,t边框,u双边框,v水印,w分列线,x字列色,y文字色,z插图色】大写打开小关闭需要连续写如℉w℉x℉y在开始中文前面]""⊕0-⊕v高度均分
		tbrUD:[10,0],//"!","^"定义下移上移标记距离
		tbrFX:[[1,0,-2,0,2],"#FFFFFFFF","#FF0000FF"],//反相图片标记[上下左右位置偏移，圆角度],前景色,背景色,是否关闭圆角矩形背景
		tagimage:[["bold 16px small-caption Segoe UI Emoji",[-4,0]],"✧✯❆❉❓❢",["#000","#000","#000","#000","#000","#000"],["、","；|;","，|,","。|\\.","？|\\?","！"]],//指定页面标点符号笔记标记[字体名,x偏移,y偏移]。标记字符,每个对应颜色,[指定替换正则可为空，这里将顿分逗句问感叹号替换
		line:["[","]"],//文字内容双行开始字符,文字内容双行结束字符
		flag:{
			bk:1,//开启边框显示
			Tbk:1,//开启 双边框
			cel:1,//开启分列线显示
			txtbk:1,//开启文字列宽背景显示
			txtbox:0,//开启文字前景色背景色显示
			picbox:0,//插图前景色背景色显示
			pageidx:2,//开启页码显示。1只显数字2加上第--页
			pagewat:1,//开启水印图标显示
			tag:1,//开启标点符号笔记标记
		},
		//path文字路径可为空是默认fontpath
		path:["","reptxt/","images/"],//【文字图片默认目录,替换文字图片默认目录.页面内图片默认目录】
		subpath:["LiuHeQiangHua/","0/","MaJiaChangQiang/"],//设置当前使用字体图片子目录，为空使用默认字体图片，各种书籍字体分开使用可方便管理删除，【当前文字图片所在子目录,当前替换文字图片所在子目录.当前页面内图片所在子目录】
		setpath:["","",""],//["","0,red,blue,green",""]subpath的选择目录，为空则自动搜索子目录，设置此值只是方便右键单击输入文字时快速插入替换文本
		txt:"",//待显示图片输入文本
		pytxt:"",//待显示图片输入文本同步拼音数组如jiǎng,shěn,hán,yáng
		replaces:{
			book:{
				flg:3,//1开启替换处理2同步显示到文本框
				name:["\\[book_name\\][^\\n]*\\n",""],
				author:["\\[book_author\\][^\\n]*\\n",""],			
				date:["\\[book_date\\][^\\n]*\\n",""],
				copyright:["\\[book_copyright\\][^\\n]*\\n",""],
				type:["\\[book_type\\][^\\n]*\\n",""],
				length:["\\[book_length\\][^\\n]*\\n",""],
				explaina:["\\[book_explain([\\[])\\]","Ξ$1%S"],//�注释[]
				explainb:["\\[book_explain([\\]])\\]","%$1"],//�注释[]
				option:["\\[book_point\\]","❖"],//点
				node:["\\[book_node\\]","◆"],//节
				nodeinfo:["\\[book_nodeinfo\\]","▼"],//节点说明
				title:["\\[book_title\\]([^\\n]+)\\n","*⬛$1⬛$$"],//章
				chapter:["\\[book_chapter\\]([^\\n]+)\\n(\\*)*","*↓⚫$1⚫$$"],//卷篇
				
			},
			txt:{
				flg:3,//1开启替换处理2同步显示到文本框
				page:["[\\n]{8,}","*"],
				title:["[\\n]{5}","|"],
				line:["[\\n]","$"],
				titleline:["[\\$]+\\|","|"],
				pageline:["[\\$]+\\*","*"]
			},
			img:{
				flg:3,//1开启替换处理2同步显示到文本框
				br:["\\n+",";"],
				tip:[";+",";"]
			},
			tfx:{
				flg:3,//1开启替换处理2同步显示到文本框,1自动补齐%标记反相到字底0不补齐反相背景到列底
				tihuan:["%([^%\$]*)%","※$1※"],			
				sousuo:["\\$([^%\\$]*%[^%\\$]*)\\$","$$$1%$$"],
				star:["^([^%\\$]*%[^%\\$]*)\\$","$1%$$"],
				end:["\\$([^%\\$]*%[^%\\$]*)$","$$$1%"],
				del:["%%",""],
				huanyuan:["※","%"]
			}
			
		},//待显示图片输入文本
		ret:"",//【替换图片输入文本《单文字序号替换如:1=0/百｜指定文字替换如:百=0/百》则可将图片替换为替换文字图片目录下的子目录0文件夹下的百.png图片】
		color:["#000F","#FFFF",0,128,0],//【文字默认前景色，文字默认背景色,通道(0r，1g，2b，3a，-1平均)，，阀值,透明时显示底层还是原图层,0底层div背景色,1原图前景,2原图背景】
		pcolor:["#F00F","#FFFF",-1,128,0,-1],//【插图默认前景色，插图默认背景色,通道(0r，1g，2b，3a，-1平均)，阀值,透明时显示底层还是原图层,0底层div背景色,1原图前景,2原图背景3原图前背景即无变化】,透明RGB一样值的纯色背景【0-255】；-1是关闭；而当该值大于255时则透明A通道小于该值-255的像素点；这对一些背景半透的图片是非常有用的【注此方法预览效果不好但是导出图片无问题】
		bk:{
			tbj:[15,15,19,15],//边框外边距左上右下
			tbw:[2,2,2,2],//边框宽度左上右下
			tbn:[10,12,6,-18],//边框内边距左上右下
			tbc:["#f00","#ff0","#00f","#0f0"],//边框颜色左上右下
			tbm:[[1,0],[1,0],[1,0],[1,0]],//边框虚实线样式【实线长度,虚线间隔长度】
			tbt:[["","zbg4.png"],["","zbg4.png"],["","zbg4.png"],["","zbg4.png"]],//边框图片样式左上右下【《默认xy平铺｜n不平铺|x平铺|y平铺｜s缩放》,图片路径】	
			twd:[2,0.2,3,0.2],//字符间距左上右下
			tof:[0,0,0,0],//字符偏移左上右下
			pwd:[9,0,-1],//增加字符拼音高度,x移位.y移位
			
		},
		col:{
			cls:7,//单页面列数
			clj:1,//分列线宽度
			tjj:[0.04,0.5],//双列x向中间靠拢间隔字宽多少百分比,宽度占字宽多少百分比
			tjb:[0.1,0.5,1],//角标字符向两边移出字宽多少百分比,宽度占字宽多少百分比,字符个数
			clt:[["#000",[5,1]],["",""],[[0,0],[0,0]]],//【[分列线颜色,分列线虚实线样式],[分列线图片样式,分列线图片路径],[[分列线颜色上,下边距]，[分列线图片上.下边距]]】
			tlt:["#fff",["xs","zbg51.png"],[[8,12],[8,5]]],//【字列背景颜色,[字列图片样式支持"[xyn]s比例canvas",字列图片路径],[[字列颜色上,下边距]，[字列图片上.下边距]]】
		},
		pgx:{//页码设置
			box:[[-2,"h-d[3]/2",12,130],"#f00",["","back3.jpg"]],//页码box:位置,"背景色",背景图片,
			loc:[[1,5,1,5,2,2],"0123456789第页空","page/2/",0,["#0f0",0,1],["","zbg4.png"]],	//页码文字位置box边距，所有文字序列，文字图片路径,是否横向《1是0否》,[背景色,是否平分间距《1是0否》,对齐方式0左/上1中2右/下],	背景图片,		
		},
		wat:{//水印图标
			atxt:{
				loc:[[0.5,0.5,30,20],"#f00",["s","zbg2.png"]],//[水印文字box位置.h增量每个文字-高度地半算居中],"背景色",背景图片,
				//and文字路径可为空是默认fontpath
				and:[[3,2,3,2],[0,19,0,0],"","","#ff0",["s",""]]//水印文字内边距，box增量。文字。路径,背景色,[样式snxy,背景图片设置无用为前面文字占用位]		
			},
			box:{
				//imgbox1:[[0.5,0,30,"H"],"",["","md5.png"]],//水印图片box位置,"背景色",背景图片,
				//imgbox2:[[0.5,"h",30,"h"],"",["s","md21.png"]],//水印图片box位置,"背景色",背景图片,
				imgbox3:[[0.5,0,30,"h"],"",["s","md01.png"]],//水印图片box位置,"背景色",背景图片,
				imgbox4:[[0.5,"h",30,"h"],"",["s","md02.png"]]//水印图片box位置,"背景色",背景图片,

			}
		},
		pic:{//页面插图
			imgpage:["{","}"],//上半图片文字从下方显示，若是第一字不会换行，若是字中会换行到顶部，下半图片,【插入图片换行置顶用{,内容中用}】
			imgset:[[0,0.4],[0,0]],//上半图片默认列数宽度【默认0为算剩余半页列数，W全页列数w半页列数如：w-1，W-2】，
									//默认高度【文字列高度百分比，1为全高，h为宽度等比缩放高度,h1上半居中。h2下半居中，H为剩余高度，默认h可加边框对齐方式：
									//【当有z左边框对齐有s上边框对齐y右边框对齐Y右半图片右边框对齐x下边框对齐。m页面下边框对齐中心，v页面上边框对齐中心,t字列上对齐。b字列下对齐.F在左边的图片取左半边右边的取右半边；两张图片全页面用；因此全边框对齐为zsyx，上半边框对齐为zsym 下半边框对齐为zvyx，全图片zsYx,字列对齐tb】;下半图片默认列数宽度，默认高度，边框对齐方式
			imgtxt:"",	//指定页面图片按页面依次加载[页面:图片名=宽度（指定宽多少列数0为默认自动算半页剩余w为对称剩余W为总列剩余）=高度（行高百分比）]	
						//如【1:6.png=w=0.5,5.jpg=4;2:7.png=8,6.jpg=5】//1:1.png=0=h1,2.png=0=h1,
						//无页面图片顺序加载【:;0:6.png=w=0.5,5.jpg=4,7.png=8,6.jpg=5】//:;0:1.png=0=h1,2.png=0=h1,
						//批量自动插入序列图片，由0开始，指定数字结束，正数为png负数为jpg【:-12;】【:9;】
		}
	},
	page:{//设置选择性页面大小
		info:"A4",//打开时默认页面
		A0:{w:889,h:1194},
		A1:{w:597,h:840},
		A2:{w:420,h:597},
		A3:{w:297,h:420},
		A4:{w:210,h:297},	
		A5:{w:148,h:210},
		A6:{w:105,h:148},
		B0:{w:787,h:1092},
		B1:{w:520,h:740},
		B2:{w:370,h:520},
		B3:{w:260,h:370},
		B4:{w:185,h:260},	
		B5:{w:130,h:185},
		B6:{w:92,h:130},
		custom:{w:0,h:0},
	},
	
	setline:{	
		n4:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.pwd=[20,0,-4];\
			ptset.bodyobj.bk.tof=[0,12,0,0];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 136px");\
			ptset.bodyobj.pfont[0]=ptset.bodyobj.pfont[0].replace(/\\s\\d+px/," 40px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 60px");',
	
		n5:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[2,0.2,3,0.2];\
			ptset.bodyobj.bk.pwd=[11,0,-1];\
			ptset.bodyobj.bk.tof=[0,2,0,0];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 100px").replace(/bold/,"lighter");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 50px").replace(/bold/,"lighter");\
			ptset.bodyobj.pfont[0]=ptset.bodyobj.pfont[0].replace(/\\s\\d+px/," 30px");\
			if(fntp.value.indexOf("XFKJZT")>=0){ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[0,-15,1,-15];\
			ptset.bodyobj.bk.pwd=[9,0,-1];\
			ptset.bodyobj.bk.tof=[2,0,0,0];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 130px").replace(/bold/,"lighter");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 65px").replace(/bold/,"lighter");}',
			//大九九乘法最后一页调整
			//ptset.bodyobj.bk.tof=[0,0,0,0];\
			//ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 120px").replace(/bold/,"lighter");\
			//ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 60px").replace(/bold/,"lighter");}',
			//ptset.bodyobj.tfont.tagimage[0]=ptset.bodyobj.tfont.tagimage[0].replace(/\\s\\d+px/," 14px");\
		n6:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.tagimage[0]=["bold 16px small-caption Segoe UI Emoji",[-4,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 74px");\
			ptset.bodyobj.pfont[0]=ptset.bodyobj.pfont[0].replace(/\\s\\d+px/," 27px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 37px");',
		n7:'ptset.bodyobj.bk.tbn=[10,12,6,-18];\
			ptset.bodyobj.tagimage[0]=["bold 14px small-caption Segoe UI Emoji",[-4,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 54px");\
			ptset.bodyobj.pfont[0]=ptset.bodyobj.pfont[0].replace(/\\s\\d+px/," 20px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 27px");',
		n8:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.tagimage[0]=["bold 14px small-caption Segoe UI Emoji",[-4,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 52px");\
			ptset.bodyobj.pfont[0]=ptset.bodyobj.pfont[0].replace(/\\s\\d+px/," 20px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 26px");',
		n9:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.tagimage[0]=["bold 12px small-caption Segoe UI Emoji",[-4,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 42px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 21px");',	
		n10:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[1,0.2,1.5,0.2];\
			ptset.bodyobj.tagimage[0]=["bold 12px small-caption Segoe UI Emoji",[-3,0]];\
			ptset.bodyobj.bk.pwd=[6,-1.2,0];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 44px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 22px");',	
			
		n11:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[1,0.2,1.5,0.2];\
			ptset.bodyobj.tagimage[0]=["bold 11px small-caption Segoe UI Emoji",[-2,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 40px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 20px");',	
		n12:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[1,0.2,1.5,0.2];\
			ptset.bodyobj.tagimage[0]=["bold 11px small-caption Segoe UI Emoji",[-2,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 36px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 18px");',	
		n13:'ptset.bodyobj.bk.tbn=[2,12,-2,-18];\
			ptset.bodyobj.bk.twd=[0.6,0.2,0.8,0.2];\
			ptset.bodyobj.col.clj=0.6;\
			ptset.bodyobj.tagimage[0]=["bold 11px small-caption Segoe UI Emoji",[-1.5,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 36px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 18px");',	
		n14:'ptset.bodyobj.bk.tbn=[2,6,-2,-16];\
			ptset.bodyobj.bk.twd=[0.8,0.2,1,0.2];\
			ptset.bodyobj.col.clj=0.6;\
			ptset.bodyobj.col.tlt[2]=[[4,13],[4,4]];\
			ptset.bodyobj.tagimage[0]=["bold 10px small-caption Segoe UI Emoji",[-2,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 32px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 16px");',	
		n15:'ptset.bodyobj.bk.tbn=[2,6,-2,-16];\
			ptset.bodyobj.bk.twd=[0.8,0.2,1,0.2];\
			ptset.bodyobj.col.clj=0.6;\
			ptset.bodyobj.col.tlt[2]=[[4,13],[4,4]];\
			ptset.bodyobj.tagimage[0]=["bold 9px small-caption Segoe UI Emoji",[-2,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 28px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 14px");',	
		n16:'ptset.bodyobj.bk.tbn=[2,6,-2,-16];\
			ptset.bodyobj.bk.twd=[0.6,0.2,0.6,0.2];\
			ptset.bodyobj.col.clj=0.4;\
			ptset.bodyobj.col.tlt[2]=[[4,13],[4,4]];\
			ptset.bodyobj.tagimage[0]=["bold 8px small-caption Segoe UI Emoji",[-1.5,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 30px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 15px");',		
		n17:'ptset.bodyobj.bk.tbn=[2,6,-2,-16];\
			ptset.bodyobj.bk.twd=[0.6,0.2,0.6,0.2];\
			ptset.bodyobj.col.clj=0.4;\
			ptset.bodyobj.col.tlt[2]=[[4,13],[4,4]];\
			ptset.bodyobj.tagimage[0]=["bold 8px small-caption Segoe UI Emoji",[-1.5,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 28px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 14px");',	
		n18:'ptset.bodyobj.bk.tbn=[2,6,-2,-16];\
			ptset.bodyobj.bk.twd=[0.6,0.2,0.6,0.2];\
			ptset.bodyobj.col.clj=0.4;\
			ptset.bodyobj.col.tlt[2]=[[4,13],[4,4]];\
			ptset.bodyobj.tagimage[0]=["bold 8px small-caption Segoe UI Emoji",[-1.5,0]];\
			ptset.bodyobj.tfont[0]=ptset.bodyobj.tfont[0].replace(/\\s\\d+px/," 26px");\
			ptset.bodyobj.bfont[0]=ptset.bodyobj.bfont[0].replace(/\\s\\d+px/," 13px");',																																																																																																																																																																																																																																																																																																																																																																																																						
	}
}
);
var itpe = null, pidx = null, merge = null, del_box = "", taobao = [], pagepdf = [pidx, 0, 0, null, 0], repsetex = function () {
	pidx = ptset.bodyobj.pageindex;
	pagepdf[0] = pidx;
	merge = ptset.bodyobj.pagemerge;
	itpe = ptset.imgtype;
	"png" == itpe[0] && (itpe[2] = "image/png", itpe[3] = "png");
	"jpg" == itpe[0] && (itpe[2] = "image/jpeg", itpe[3] = "jpg")
};
repsetex();
var defsetline = function () {
	bookIndex.value = lput.value = rput.value = pyput.value = "";
	fntp.selectedIndex = 0;
	setfont("Kai-01,Kai-02,Kai-03;140", "kaiT");
	ptset.bodyobj.bk.tbn = [10, 12, 6, -18];
	ptset.bodyobj.bk.twd = [2, .2, 3, .2];
	ptset.bodyobj.bk.tof = [0, 0, 0, 0];
	ptset.bodyobj.bk.pwd = [9, 0, -1];
	ptset.bodyobj.col.clj = 1;
	ptset.bodyobj.col.tlt[2] = [[8, 12], [8, 5]];
	ptset.bodyobj.tagimage[0] = ["bold 16px small-caption Segoe UI Emoji", [-4, 0]];
	ptset.bodyobj.pfont[0] = "bold 20px " + fontlist.HZPY[0];
	ptset.bodyobj.wfont[0] = "bold 54px " + fontlist.kaiT[0];
	coverpytxtflg.value = "\ud83d\udd32";
	oneotb.value = "\ud83d\udd32\u5355\u9875\u9762\u9501\u5b9a";
	mrrorbk.checked = !1
};
fntp.options.add(new Option("\u5b57\u4f53", ""));
fontfm.options.add(new Option("\u5b57\u4f53", ""));
fontwm.options.add(new Option("\u5b57\u4f53", ""));
var arr = Object.entries(fontlist), i;
for (i in arr)
	3 < arr[i][0].length && (fntp.options.add(new Option(arr[i][0], arr[i][1].join(";"))), fontfm.options.add(new Option(arr[i][0], arr[i][1][0])), fontwm.options.add(new Option(arr[i][0], arr[i][1][0])));
var setfontftb = function () {
	var a = [[], [], []],
	c = Object.entries(fontlist),
	b;
	for (b in c)
		a[0].push(c[b][1].join(";")), a[1].push([c[b][1][0], c[b][1][1] - 1].join(";")), a[2].push(c[b][0] + "/");
	ptset.fontTAB = a
};
setfontftb();
var setfont = function (a, c) {
	fontpath = fontspath + c + "/";
	var b = a.split(";");
	b[1] = Number(b[1]);
	0 > fntp.value.indexOf("XFKJZT") && (ptset.bodyobj.titfont[0] = ptset.bodyobj.titfont[0].replace(/px\s.+/, "px " + b[0]), ptset.bodyobj.titfont[1][3] = b[1]);
	ptset.bodyobj.tfont[0] = ptset.bodyobj.tfont[0].replace(/px\s.+/, "px " + b[0]);
	ptset.bodyobj.tfont[1][3] = b[1];
	ptset.bodyobj.bfont[0] = ptset.bodyobj.bfont[0].replace(/px\s.+/, "px " + b[0]);
	ptset.bodyobj.bfont[1][3] = b[1] - 1
}, ptsetInfo = JSON.stringify(ptset), ptobj = JSON.parse(ptsetInfo), bookpath = imgpath + ptobj.bookpath, bodypath = imgpath + ptobj.bodypath, infopath = imgpath + ptobj.infopath, backpath = imgpath + ptobj.backpath, fontspath = imgpath + ptobj.fontspath, fontpath = fontspath + ptobj.fontpath, infoimage = ptobj.infoimage, nowhimage = ptobj.nowhimage, lock = 0, starnul = 0, canvs = ByID("canvs"), canv = canvs.getContext("2d", {
		willReadFrequently : !0
	}), txtbkimg = new Image, Tlist = null, CZTlist = 0, bkarr = null, bkarr2 = null, cover = function (a) {
	for (var c = 0; c < a.length; c++)
		a[c] *= mmpx
}, getrct = function (a) {
	if ("s" == a[0])
		return 0;
	var c = "repeat";
	"n" == a[0] && (c = "no-repeat");
	"x" == a[0] && (c = "repeat-x");
	"y" == a[0] && (c = "repeat-y");
	return c
}, getimgcv = function (a, c, b) {
	if (ByID("mrrorbk").checked) {
		var d = document.createElement("canvas"),
		g = d.getContext("2d"),
		e = d.width = a.naturalWidth,
		l = d.height = a.naturalHeight;
		g.drawImage(a, 0, 0, e, l);
		var k = g.getImageData(0, 0, e, l),
		p = k.data;
		if (a.src !== ptset.bookobj.box.qrbox[2][1] && a.src !== ptset.bookobj.box.brbox[2][1] && a.src !== ptset.bookobj.box.cealbox[2][1]) {
			for (var n = [], m = 0; m < p.length; m++)
				n[m] = p[m];
			for (m = 0; m < e; m++)
				for (var h = 0; h < l; h++) {
					var q = 4 * (m + h * e),
					f = 4 * (e - 1 - m + h * e);
					p[f + 0] = n[q + 0];
					p[f + 1] = n[q + 1];
					p[f + 2] = n[q + 2];
					p[f + 3] = n[q + 3]
				}
		}
		g.putImageData(k, 0, 0);
		if (2 > c.length)
			return d
	} else if (2 > c.length)
		return a;
	e = c[1];
	b && "p" != e || (b = [canvs.width, canvs.height]);
	g = b[1];
	b = b[0];
	if ("s" == e || "p" == e)
		e = c[0];
	b && "x" != e || (c = a.naturalWidth / a.naturalHeight, b = g * c);
	g && "y" != e || (c = a.naturalHeight / a.naturalWidth, g = b * c);
	c = document.createElement("canvas");
	e = c.getContext("2d");
	c.width = b;
	c.height = g;
	ByID("mrrorbk").checked ? e.drawImage(d, 0, 0, c.width, c.height) : e.drawImage(a, 0, 0, c.width, c.height);
	return c
}, setbackcolor = function (a) {
	var c = 0;
	2 == a && "#" !== ptset.bodyobj.bkpic[2] && (c = 1);
	1 == a && "#" !== ptset.bookobj.bkpic[2] && (c = 1);
	if (c) {
		ptset.backcolor && (canv.beginPath(), canv.fillStyle = colorint(ptset.backcolor), canv.fillRect(0, 0, canvs.width, canvs.height), canv.closePath());
		var b = ptset.backimage;
		if (b[1]) {
			var d = new Image;
			d.src = "?" == b[1][0] && ptset.bodyobj.path[2] && ptset.bodyobj.subpath[2] ? upurl(bodypath + ptset.bodyobj.path[2] + ptset.bodyobj.subpath[2] + b[1].slice(1)) : upurl(backpath + b[1]);
			d.setAttribute("crossOrigin", "anonymous");
			d.onload = function (a) {
				a = getimgcv(d, b[0], [canvs.width, canvs.height]);
				var c = getrct(b[0]);
				c ? (a = canv.createPattern(a, c), canv.fillStyle = a, canv.fillRect(0, 0, canvs.width, canvs.height)) : canv.drawImage(a, 0, 0, canvs.width, canvs.height)
			}
		}
	}
}, backcolorfor = function (a, c, b) {
	setTimeout(function () {
		"#" == a[2][0] && (canv.beginPath(), canv.fillStyle = colorint(a[2]), canv.fillRect(0, 0, canvs.width, canvs.height), canv.closePath());
		if (a[1][1]) {
			var d = new Image;
			d.src = "?" == a[1][1][0] && ptset.bodyobj.path[2] && ptset.bodyobj.subpath[2] ? upurl(bodypath + ptset.bodyobj.path[2] + ptset.bodyobj.subpath[2] + a[1][1].slice(1)) : upurl(backpath + a[1][1]);
			d.setAttribute("crossOrigin", "anonymous");
			d.onload = function (g) {
				cover(a[0]);
				var e = a[0];
				g = 0 < e[0] ? Math.min(e[0], this.naturalWidth) : 0;
				var l = 0 < e[1] ? Math.min(e[1], this.naturalHeight) : 0,
				k = 0 < e[2] ? Math.min(e[2], this.naturalWidth) : 0 > e[2] ? canvs.width : this.naturalWidth,
				p = 0 < e[3] ? Math.min(e[3], this.naturalHeight) : 0 > e[3] ? canvs.height : this.naturalHeight,
				n = 0 < e[4] ? Math.min(e[4], canvs.width) : 0,
				m = 0 < e[5] ? Math.min(e[5], canvs.height) : 0,
				h = 0 < e[6] ? Math.min(e[6], canvs.width) : canvs.width,
				q = 0 < e[7] ? Math.min(e[7], canvs.height) : canvs.height,
				e = getimgcv(d, a[1][0], [k, p]),
				f = getrct(a[1][0]);
				f ? ("repeat" == f && (n = document.createElement("canvas"), m = n.getContext("2d"), n.width = e.width * b, n.height = e.height * b, m.drawImage(e, 0, 0, n.width, n.height), e = n), e = canv.createPattern(e, f), canv.fillStyle = e, canv.fillRect(g, l, k, p)) : canv.drawImage(e, g, l, k, p, n, m, h, q);
				c()
			};
			d.onerror = function (a) {
				c()
			}
		} else
			c()
	}, 2E3)
}, rgbaToColor = function (a) {
	if (/rgb/.test(a)) {
		a = a.replace(/[^\d,]+/g, "");
		a = a.split(",");
		var c = "",
		b;
		for (b in a) {
			a[b] = parseInt(a[b]);
			var d = parseInt(a[b] / 16),
			c = c + (9 < d ? String.fromCharCode(parseInt(d) + 87) : d),
			d = parseInt(a[b] % 16),
			c = c + (9 < d ? String.fromCharCode(parseInt(d) + 87) : d)
		}
		a = "#" + c
	}
	return a
}, colorint = function (a) {
	if (9 == a.length) {
		a = a.replace("#", "");
		a = a.match(/[a-fA-F0-9]{2}/g);
		for (var c = 0; c < a.length; c++)
			a[c] = parseInt(a[c], 16);
		a = "rgba(" + a.toString() + ")"
	}
	return a
}, colortoint = function (a) {
	for (var c = 0; c < a.length; c++)
		a[c] = parseInt(a[c], 16);
	return a
}, colorforint = function (a) {
	a[0] = parseInt(a[0]);
	a[1] = parseInt(a[1]);
	a[2] = parseInt(a[2]);
	a[3] = parseInt(255 * a[3]);
	return a
}, toCvDataURL = function (a, c) {
	if ("\u2611\ufe0f\u6279\u91cf" == autotb.value) {
		var b = document.createElement("canvas"),
		d = b.getContext("2d");
		b.width = 800;
		var g = a.width,
		e = a.height;
		if (g > e) {
			var l = Math.ceil(b.width * e / g);
			b.height = l;
			d.drawImage(a, 0, 0, b.width, l);
			return b.toDataURL("image/jpeg", .8)
		}
		b.height = 800;
		d.fillStyle = "rgba(255,255,255,255)";
		d.fillRect(0, 0, b.width, b.height);
		d.clearRect(0, 0, b.width, b.height);
		var k = Math.ceil(b.height * g / e);
		d.drawImage(a, (b.width - k) / 2, 0, k, b.height);
		return b.toDataURL("image/png", .8)
	}
	return c ? (b = document.createElement("canvas"), d = b.getContext("2d"), g = canvs.width, e = canvs.height, k = c[0], l = c[1], k && !l && (l = k / g * e), l && !k && (k = l / e * g), l || k || (k = g, l = e), b.height = l, b.width = k, d.drawImage(canvs, 0, 0, b.width, b.height), b.toDataURL("image/jpeg", .95)) : a.toDataURL(itpe[2], itpe[1])
}, fontprint = function (a, c) {
	var b = a[0],
	b = parseInt(b.match(/\s(\d+)px/)[1]) * c,
	b = a[0].replace(/\s\d+px/, " " + b + "px");
	canv.font = b;
	b = [0, 0, canvs.width, 0];
	a[3] & 1 && (b[1] = b[3] = canvs.height / 2);
	a[3] & 2 && (b[0] = b[2] = canvs.width / 2);
	a[3] & 4 && (b[3] = canvs.height);
	a[3] & 8 && (b[2] = canvs.width / 2);
	a[3] & 16 && (b[0] = canvs.width / 2);
	a[3] & 32 && (b[3] = canvs.height / 2);
	a[3] & 64 && (b[1] = canvs.height / 2);
	for (var b = canv.createLinearGradient(b[0], b[1], b[2], b[3]), d = 0; d < a[2].length; d++) {
		var g = (d + 1) / a[2].length.toFixed(2).toString();
		b.addColorStop(g, a[2][d])
	}
	canv.fillStyle = b
}, uflg = Number(ptset.bodyobj.trand);
autoflg = 0;
var fliespt = "#_", otxt = "", spdf = function (a) {
	if (pagepdf[0] || ptset.bookobj.height[1] && ptset.bodyobj.height[1])
		pagepdf[1] = pagepdf[1] ? pagepdf[1] : canvs.width / .75, pagepdf[2] = pagepdf[3] ? pagepdf[2] : canvs.height / .75, pagepdf[4] = pagepdf[1] > pagepdf[2] ? "l" : "p", pagepdf[3] = pagepdf[3] ? pagepdf[3] : new jsPDF(pagepdf[4], "pt", [pagepdf[1], pagepdf[2]], !1), pagepdf[3].addImage(toCvDataURL(canvs), itpe[3], 0, 0, pagepdf[1], pagepdf[2], null, "none");
	else {
		(a = ptset.bodyobj.dpi) || (a = inpx);
		mmpx = a / 25.4;
		var c = ptset.page[ptset.bodyobj.page],
		b = ptset.bodyobj.height;
		a = c.w * mmpx;
		c = c.h * mmpx;
		b[1] && (a = 2 * a + b[0] * mmpx);
		var b = document.createElement("canvas"),
		d = b.getContext("2d");
		b.width = a;
		b.height = c;
		var g = Math.max(canvs.width - a, 0),
		e = canv.getImageData(0, 0, a, c);
		d.putImageData(e, 0, 0);
		pagepdf[1] = pagepdf[1] ? pagepdf[1] : a / .75;
		pagepdf[2] = pagepdf[2] ? pagepdf[2] : c / .75;
		pagepdf[4] = pagepdf[1] > pagepdf[2] ? "l" : "p";
		pagepdf[3] = pagepdf[3] ? pagepdf[3] : new jsPDF(pagepdf[4], "pt", [pagepdf[1], pagepdf[2]], !1);
		pagepdf[3].addImage(toCvDataURL(b), itpe[3], 0, 0, pagepdf[1], pagepdf[2], null, "none");
		g && (pagepdf[3].addPage(), e = canv.getImageData(g, 0, a, c), d.putImageData(e, 0, 0), pagepdf[3].addImage(toCvDataURL(b), itpe[3], 0, 0, pagepdf[1], pagepdf[2], null, "none"))
	}
}, spng = function (a) {
	var c = pagepdf[0];
	starnul && "#-" == fliespt && (c = starnul, starnul = 0, a = pagepdf[0] ? 1 : 0);
	var c = ptname.value + fliespt + c + "." + itpe[0],
	b = toCvDataURL(canvs).split(",")[1];
	upfile(c, b, a)
}, upfile = function (a, c, b, d) {
	click_error()
}, upurl = function (a) {
	return a.match(/get.php\?img=(.+)/)[1]
}, dhstxt = function (a, c, b, d, g, e, l, k) {
	if (!(1 > d || 1 > g)) {
		var p = !1;
		3 < k && (k -= 4, p = !0);
		var n = document.createElement("canvas"),
		m = n.getContext("2d");
		e = colortoint(recolor(e).replace("#", "").match(/[a-fA-F0-9]{2}/g));
		l = colortoint(recolor(l).replace("#", "").match(/[a-fA-F0-9]{2}/g));
		n.width = d;
		n.height = g;
		m.drawImage(a, 0, 0, d, g);
		a = m.getImageData(0, 0, d, g);
		var h = a.data;
		d = canv.getImageData(c, b, d, g).data;
		0 == k && (k = [0, 128, 1]);
		1 == k && (k = [ptobj.bodyobj.pcolor[2], ptobj.bodyobj.pcolor[3], ptobj.bodyobj.pcolor[4]]);
		2 == k && (k = [ptobj.bodyobj.color[2], ptobj.bodyobj.color[3], ptobj.bodyobj.color[4]]);
		g = -1 < ptobj.bodyobj.pcolor[5] ? ptobj.bodyobj.pcolor[5] : -1;
		for (var q = 0 > k[0] ? 0 : k[0], f = 0; f < h.length; f += 4)
			p ? (h[f + 3] ? (h[f] = e[3] ? e[0] : k[2] & 1 ? h[f] : d[f], h[f + 1] = e[3] ? e[1] : k[2] & 1 ? h[f + 1] : d[f + 1], h[f + 2] = e[3] ? e[2] : k[2] & 1 ? h[f + 2] : d[f + 2]) : (h[f] = l[3] ? l[0] : k[2] & 2 ? h[f] : d[f], h[f + 1] = l[3] ? l[1] : k[2] & 2 ? h[f + 1] : d[f + 1], h[f + 2] = l[3] ? l[2] : k[2] & 2 ? h[f + 2] : d[f + 2]), m.putImageData(a, 0, 0)) : -1 < g ? 255 < g ? h[f + 3] < g - 255 && (h[f] = d[f], h[f + 1] = d[f + 1], h[f + 2] = d[f + 2], h[f + 3] = d[f + 3]) : 255 == h[f + 3] && h[f + 0] == g && h[f + 1] == g && h[f + 2] == g && (h[f] = d[f], h[f + 1] = d[f + 1], h[f + 2] = d[f + 2], h[f + 3] = d[f + 3]) : (0 > k[0] && (h[f + q] = parseInt(.3 * h[f] + .59 * h[f + 1] + .11 * h[f + 2]) >= k[1] ? 255 : 0), 255 == h[f + 3] && h[f + q] < k[1] ? (h[f] = e[3] ? e[0] : k[2] & 1 ? h[f] : d[f], h[f + 1] = e[3] ? e[1] : k[2] & 1 ? h[f + 1] : d[f + 1], h[f + 2] = e[3] ? e[2] : k[2] & 1 ? h[f + 2] : d[f + 2], h[f + 3] = e[3] ? e[3] : k[2] & 1 ? h[f + 3] : d[f + 3]) : (h[f] = l[3] ? l[0] : k[2] & 2 ? h[f] : d[f], h[f + 1] = l[3] ? l[1] : k[2] & 2 ? h[f + 1] : d[f + 1], h[f + 2] = l[3] ? l[2] : k[2] & 2 ? h[f + 2] : d[f + 2], h[f + 3] = l[3] ? l[3] : k[2] & 2 ? h[f + 3] : d[f + 3]));
		p ? canv.drawImage(n, c, b) : canv.putImageData(a, c, b)
	}
}, recolor = function (a) {
	"#" !== a[0] && (a = "#" + a);
	var c = a = a.toLocaleUpperCase();
	2 == a.length && (c = a[0] + a[1] + a[1] + a[1] + a[1] + a[1] + a[1] + "FF");
	3 == a.length && (c = a[0] + a[1] + a[1] + a[1] + a[2] + a[2] + a[2] + "FF");
	4 == a.length && (c = a[0] + a[1] + a[1] + a[2] + a[2] + a[3] + a[3] + "FF");
	5 == a.length && (c = a[0] + a[1] + a[1] + a[2] + a[2] + a[3] + a[3] + a[4] + a[4]);
	9 !== c.length && (c = "#FFFFFFFF");
	return c.replace("#", "")
}, coverxy = function (a, c, b) {
	for (b = 0; b < a.length; b++)
		if ("string" === typeof a[b])
			switch (a[b][0]) {
			case "W":
				a[b] = eval(a[b].replace("W", "page.w"));
				break;
			case "w":
				a[b] = eval(a[b].replace(/w/g, "page.w/2"));
				break;
			case "H":
				a[b] = eval(a[b].replace("H", "page.h"));
				break;
			case "h":
				a[b] = eval(a[b].replace("h", "page.h/2"));
				break;
			case "X":
				a[b] = eval(a[b].replace("X", "(page.w-ht[0])/2+ht[0]"));
				break;
			case "x":
				a[b] = eval(a[b].replace("x", "(page.w-ht[0])/2"));
				break;
			case "T":
				a[b] = eval(a[b].replace("T", "ht[0]"));
				break;
			case "t":
				a[b] = eval(a[b].replace("t", "ht[0]/2"))
			}
	0 > a[0] && (a[0] = c.w + a[0] - a[2]);
	0 > a[1] && (a[1] = c.h + a[1] - a[3]);
	1 > a[0] && 0 < a[0] && (a[0] = c.w * a[0] - a[2] / 2);
	1 > a[1] && 0 < a[1] && (a[1] = c.h * a[1] - a[3] / 2)
}, txtcover = function (a, c) {
	a[2] = 0 < a[2] && 1 > a[2] ? a[2] * c[2] : c[2] - a[2] - a[0];
	a[3] = 0 < a[3] && 1 > a[3] ? a[3] * c[3] : c[3] - a[3] - a[1];
	a[0] = 0 > a[0] ? c[2] + a[0] - a[2] : 0 < a[0] && 1 > a[0] ? c[0] * a[0] : c[0] + a[0];
	a[1] = 0 > a[1] ? c[3] + a[1] - a[3] : 0 < a[1] && 1 > a[1] ? c[1] * a[1] : c[1] + a[1]
}, pgbr = function (a) {
	br = "";
	for (var c = 0; c < a; c++)
		br += ptobj.bodyobj.tbr[0];
	return br
}, afg = 1, bfg = 1, tdh = 0, tlh = 0, thy = 0, tflg = 0, lastflg = 0, imgid = 0, nullpage = 0, sendName = "name.json", sendclick = function (a) {
	alertbox(345, 360, "\u8fdb\u5ea6:", '\x3cdiv id\x3d"logdiv" style\x3d"width:345px;height:336px;overflow-x:hidden;"\x3e\x3c/div\x3e', "read", 1);
	a = a.replace(/;(\\t)+/g, ";");
	a = a.replace(/[\t\r\n]+/g, "");
	if(errtxt.innerHTML[0]=="⛔"){ByID("logdiv").innerHTML = errtxt.innerHTML;return;}
	var c = function (a) {
		a.onload = function (b) {
			ByID("logdiv").scrollTop = ByID("logdiv").scrollHeight;
			canvs.width = a.naturalWidth;
			canvs.height = a.naturalHeight;
			canv.drawImage(a, 0, 0, canvs.width, canvs.height);
			lock = 0;
			bfg = afg = 1;
			autoflg = tlh = tdh = 0
		}
	},
	b = window.XMLHttpRequest ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
	b.onreadystatechange = function () {
		if (3 === b.readyState || 4 === b.readyState)
			try {
				if (200 === b.status)
					if (txt = b.responseText, lock = 0, /path\$\?/.test(txt)) {
						var a = "\u5e8f\u5217\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\u3002\u3002\u3002\u9501\u5b9a\u4e2d\x3cbr\x3e",
						g = txt.replace("path$?", ""),
						a = a + (g + "\x3cbr\x3e\u5f85\u6b64\u4efb\u52a1\u540e\u518d\u8bd5\u3002\u3002\u3002\x3cbr\x3e");
						ByID("logdiv").title = g;
						a += '\x3cspan id\x3d"logdivck" class\x3d"btnb"\x3e\u67e5\u770b\u6b64\u4efb\u52a1\x3c/span\x3e\x3cbr\x3e';
						g = sendExeUrl + g;
						ByID("logdiv").innerHTML = a;
						ByID("logdivck").onclick = function (a) {
							var b = function (a) {
								var d = window.XMLHttpRequest ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP");
								d.onreadystatechange = function () {
									if (4 === d.readyState)
										try {
											if (200 === d.status) {
												var e = d.responseText;
												ByID("logdiv").innerHTML = e.replace(/\u27a2|\n/g, "\x3cbr\x3e");
												ByID("logdiv").scrollTop = ByID("logdiv").scrollHeight;												
												if (/json\.png[\r\n]*$/.test(e)) {
													ByID("logdiv").innerHTML += 'Image output is ok:\x3cbr\x3e\x3cimage id\x3d"retimg" width\x3d345 src\x3d"' + g + '.png"\x3e';
													ByID("retimg") && c(ByID("retimg"));
													ptset=ptsetInfo;
													var tmu=ptset.bodyobj.col.cls;
													if(ptset.setline["n"+tmu])eval(ptset.setline["n"+tmu].replace(/[\r\n\t]/g,""));
													try{localStorage.setrandcls=ptset.bodyobj.trand+","+ptset.bodyobj.col.cls;}catch(e){}
													setinfo();start();
												} else
													setTimeout(function () {
														120 > ++a && b(a)
													}, 1E3)
														
											} else
												d.status && alert("geturl\u51fa\u9519\n\u7f51\u5740\u672a\u8fde\u901a:" + d.status)
										} catch (m) {}

								};
								d.open("GET", sendExeUrl + "get.php?log\x3d" + ByID("logdiv").title + ".log\x26t\x3d" + (new Date).getTime(), !0);
								d.send()
							};
							b(0)
						}
					} else
						ByID("logdiv").innerHTML = txt, ByID("logdiv").scrollTop = ByID("logdiv").scrollHeight, ByID("retimg") && c(ByID("retimg"));
				else
					b.status && alert("\u51fa\u9519\n\u7f51\u5740\u672a\u8fde\u901a:" + b.status)
			} catch (e) {}

	};
	b.open("POST", sendExeUrl + "chromeDriver_headerless.php?guid\x3dnull\x26t\x3d" + (new Date).getTime(), !0);
	b.timeout = 0;
	b.ontimeout = function () {};
	b.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	b.send("ptsetmp\x3d" + (new function (a) {
			var b = a ? a : "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d";
			this.encode = function (a) {
				var c = "",
				d,
				e,
				g,
				m,
				h,
				q,
				f = 0;
				for (a = _utf8_encode(encodeURI(a)); f < a.length; )
					d = a.charCodeAt(f++), e = a.charCodeAt(f++), g = a.charCodeAt(f++), m = d >> 2, d = (d & 3) << 4 | e >> 4, h = (e & 15) << 2 | g >> 6, q = g & 63, isNaN(e) ? h = q = 64 : isNaN(g) && (q = 64), c = c + b.charAt(m) + b.charAt(d) + b.charAt(h) + b.charAt(q);
				return c
			};
			this.decode = function (a) {
				var c = "",
				d,
				e,
				g,
				m,
				h,
				q = 0;
				for (a = a.replace(/[^A-Za-z0-9\+\/\=]/g, ""); q < a.length; )
					d = b.indexOf(a.charAt(q++)), e = b.indexOf(a.charAt(q++)), m = b.indexOf(a.charAt(q++)), h = b.indexOf(a.charAt(q++)), d = d << 2 | e >> 4, e = (e & 15) << 4 | m >> 2, g = (m & 3) << 6 | h, c += String.fromCharCode(d), 64 != m && (c += String.fromCharCode(e)), 64 != h && (c += String.fromCharCode(g));
				return _utf8_decode(c)
			};
			_utf8_encode = function (a) {
				a = a.replace(/\r\n/g, "\n");
				for (var b = "", c = 0; c < a.length; c++) {
					var d = a.charCodeAt(c);
					128 > d ? b += String.fromCharCode(d) : (127 < d && 2048 > d ? b += String.fromCharCode(d >> 6 | 192) : (b += String.fromCharCode(d >> 12 | 224), b += String.fromCharCode(d >> 6 & 63 | 128)), b += String.fromCharCode(d & 63 | 128))
				}
				return b
			};
			_utf8_decode = function (a) {
				var b = "",
				c = 0,
				d;
				for (c1 = c2 = 0; c < a.length; )
					d = a.charCodeAt(c), 128 > d ? (b += String.fromCharCode(d), c++) : 191 < d && 224 > d ? (c2 = a.charCodeAt(c + 1), b += String.fromCharCode((d & 31) << 6 | c2 & 63), c += 2) : (c2 = a.charCodeAt(c + 1), c3 = a.charCodeAt(c + 2), b += String.fromCharCode((d & 15) << 12 | (c2 & 63) << 6 | c3 & 63), c += 3);
				return b
			}
		}).encode(a) + "\x26end\x3dChromeDiver\x26host\x3d" + sendExeUrl + "\x26txt\x3d" + sendName + "\x26time\x3d" + (new Date).getTime())
}, onbody = function () {
	boxdiv.innerHTML = "";
	uflg = Number(ptset.bodyobj.trand);
	800 < ptset.bodyobj.pic.imgtxt.length && (ptset.bodyobj.pic.imgtxt = ptset.bodyobj.pic.imgtxt.slice(0, 800));
	800 < ptset.bodyobj.txt.length && (ptset.bodyobj.txt = ptset.bodyobj.txt.slice(0, 800));
	800 < ptset.bodyobj.ret.length && (ptset.bodyobj.ret = ptset.bodyobj.ret.slice(0, 800));
	1600 < ptset.bodyobj.pytxt.length && (ptset.bodyobj.pytxt = ptset.bodyobj.pytxt.slice(0, 1600));
	ptset.setbookIndex = {
		pidx : pidx,
		pagepdf : pagepdf[0],
		clickId : "ptbody"
	};
	var a = JSON.stringify(ptset);
	ptobj = JSON.parse(a);
	sendclick(a)
}, onbook = function () {
	boxdiv.innerHTML = "";
	uflg = Number(ptset.bodyobj.trand);
	800 < ptset.bodyobj.txt.length && (ptset.bodyobj.txt = ptset.bodyobj.txt.slice(0, 800));
	ptset.setbookIndex = {
		pidx : pidx,
		pagepdf : pagepdf[0],
		clickId : "ptbook"
	};
	var a = JSON.stringify(ptset);
	ptobj = JSON.parse(a);
	sendclick(a)
}, machflg = function () {
	for (var a = document.getElementsByName("cktxt"), c = 0, b = 0; b < a.length; b++)
		c += a[b].checked ? 1 << b : 0;
	return c
}, numtocn = function (a) {
	return a = a.replace(/[&]*\d+\.?\d*/g, function (a) {
			if ("\x26" == a[0] || "%" == a[0])
				return a;
			a = a.toString().split(".");
			var b = "",
			c = function (a) {
				for (var c = a.length - 1, d = "\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396".split(""), g = " \u62fe \u4f70 \u4edf \u842c \u62fe \u4f70 \u4edf \u5104 \u62fe \u4f70 \u4edf \u5797 \u62fe \u4f70 \u4edf \u4eb0".split(" "), p = 0; p < a.length; p++) {
					var n = parseInt(a[p]);
					b += d[n] + g[c];
					c--
				}
			};
			c(a[0]);
			a[1] && (b += "\u70b9", c(a[1]));
			b = b.replace(/\u96f6[\u4edf\u4f70\u62fe]/g, "\u96f6");
			b = b.replace(/\u96f6+/g, "\u96f6");
			b = b.replace(/\u96f6([\u842c\u5104\u5797\u4eb0])/g, "$1");
			"\u96f6" == b[b.length - 1] && (b = b.slice(0, -1));
			b = b.replace(/(.)\u96f6\u70b9/g, "$1\u70b9");
			/[\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396]/.test(b) || (b = "\u96f6");
			return b
		})
}, repimg = function (a) {
	var c = a.match(/\{[\{\}][^\.]+\.[pngj]+=[^\}]+\}/g);
	c && (c = c.join("") + ",", c = c.replace(/\}\{/g, ","), c = c.replace(/\}|\{/g, ""), a = a.replace(/\{([\{\}])[^\.]+\.[pngj]+=[^\}]+\}/g, "$1"));
	return [a, c]
}, conftxt = function (a) {
	var c = a.match(/\[config\]([\W\w]+)\[config\]\n?/),
	c = c ? c[1] : "",
	b = null;
	if (!utindex) {
		var d = a.match(/\[book_name\]([^\n]+)/),
		g = a.match(/\[book_author\]([^\n]+)/),
		e = a.match(/\[book_date\]([^\n]+)/),
		l = a.match(/\[book_copyright\]([^\n]+)/),
		k = a.match(/\[book_length\]([^\n]+)/);
		d && (defsetline(), ptwat.value = ptname.value = d[1].replace(/[^\u3400-\uFAD9]+/g, "").replace(/^\s|\s$/g, ""), upchang(ptwat), upchang(ptname));
		l && (ptcopyright.value = l[1], upchang(ptcopyright));
		if (e || g)
			g = g ? g[1] : "", e = e ? e[1].replace(/[^=\d\s\-_\u3400-\uFAD9]+/g, "").replace(/^\s|\s$/g, "").split(/\s|\-|_|=/g) : "", e[1] = e[1] ? e[1] : "", 1 == e[0].length && (e[0] += "\u671d"), ptauthor.value = g ? e[0] + "\x3d" + g : e[0] + "\x3d" + e[1], upchang(ptauthor);
		k && ("0" == k[1] && (d = a.match(/\[config\][\W\w]+\[config\]\n([\W\w]+)?/), k[1] = d && d[1] ? d[1].match(/[\ud840-\ud888]*[\u3400-\uFAD9\}\{]/g).length : 0), bkleg.innerHTML = 'TLG:\x3cfont color\x3d"#f00"\x3e' + k[1] + "\x3cfont\x3e")
	}
	/\[book_[a-z]+\]/.test(a) && (b = []);
	if (c) {
		txtconf = c;
		for (var c = c.split("\n"), p = "", k = 0; k < c.length; k++)
			if (c[k] = c[k].replace(/[^:][\s]*\/\/[^\n]+/, ""), c[k])
				if (d = c[k].split("@"), "namebox-y" == d[0] && "false" !== d[1])
					d = Number(d[1]), (ptset.bookobj.loads.box.namebox[0][2] - ptset.bookobj.loads.text.name[0][0] - ptset.bookobj.loads.text.name[0][2]) * ptset.bookobj.loads.text.name[1].length > ptset.bookobj.loads.box.namebox[0][3] && (ptset.bookobj.loads.box.namebox[0][1] += d, ptset.bookobj.loads.box.authorbox[0][1] += d, ptset.bookobj.box.cealbox[0][1] += d);
				else if ("namebox-h" == d[0] && "false" !== d[1])
					d = Number(d[1]), (ptset.bookobj.loads.box.namebox[0][2] - ptset.bookobj.loads.text.name[0][0] - ptset.bookobj.loads.text.name[0][2]) * ptset.bookobj.loads.text.name[1].length > ptset.bookobj.loads.box.namebox[0][3] && (ptset.bookobj.loads.box.namebox[0][3] += d, ptset.bookobj.loads.box.authorbox[0][1] += d, ptset.bookobj.box.cealbox[0][1] += d);
				else if ("." == d[0][5])
					d[1] && "false" !== d[1] && (p += d[0] + "\x3d" + d[1] + ";");
				else {
					if (ByID(d[0])) {
						if ("checkbox" == ByID(d[0]).type || "radio" == ByID(d[0]).type)
							ByID(d[0]).checked = "false" == d[1] ? !1 : !0;
						else if ("SELECT" == ByID(d[0]).tagName) {
							var g = ByID(d[0]).options,
							n;
							for (n in g)
								if (g[n].innerHTML == d[1]) {
									ByID(d[0]).value = g[n].value;
									break
								}
						} else
							"dpi" == d[0] ? (ptset.bookobj.dpi = parseInt(d[1]), upchang(pgs), ptset.bodyobj.dpi = parseInt(d[1]), upchang(pgs)) : "false" !== d[1] && (ByID(d[0]).value = d[1]);
						upchang(ByID(d[0]))
					}
					"match" == d[0] && "false" !== d[1] && (b = JSON.parse(d[1]))
				}
		setTimeout(function () {
			eval(p)
		}, 500)
	}
	a = a.replace(/\[config\]([\W\w]+)\[config\]\n?/, "");
	if (b) {
		for (k = 0; k < b.length; k++)
			b[k] && (c = new RegExp(b[k][0], "g"), a = a.replace(c, b[k][1]));
		b = ptset.bodyobj.replaces.book;
		if (b.flg & 1)
			for (var m in b)
				"number" != typeof b[m] && (c = new RegExp(b[m][0], "g"), a = a.replace(c, b[m][1]), b.flg & 2 && (lput.value = a));
		a = machtxt(a, 2047)
	}
	return a
}, machtxt = function (a, c) {
	var b = repimg(a);
	a = lput.value = b[0];
	b[1] && (mput.value ? ";" == mput.value[1] && (mput.value += b[1]) : mput.value = ":;0:" + b[1]);
	a = conftxt(a);
	a = a.replace(/[\uff01-\uff5e\u3000]/g, function (a) {
			return "\uff01" == a ? a : a = 12288 == a.charCodeAt(0) ? String.fromCharCode(32) : String.fromCharCode(a.charCodeAt(0) - 65248)
		});
	c & 2048 && (a = numtocn(a));
	c & 4096 || (a = a.replace(/([^&%\u2109\u2295])[a-zA-Z]+/g, "$1"));
	b = Array(19);
	b[0] = c & 1 ? "[,]\x3d\uff0c" : "[\uff0c,]\x3d";
	b[1] = c & 2 ? "[\\.]\x3d\u3002" : "[\u3002\\.]\x3d";
	b[2] = c & 4 ? "[\\?]\x3d\uff1f" : "[\uff1f\\?]\x3d";
	b[3] = c & 4 ? "" : "[\uff01]\x3d";
	b[4] = c & 4 ? "[\u2026]+\x3d\u2026" : "[\u2026]+\x3d";
	b[5] = c & 8 ? "[;]\x3d\uff1b" : "[;\uff1b]\x3d";
	b[6] = c & 8 ? "" : "[\u3001]\x3d";
	b[7] = c & 16 ? "" : "[\u201d\u201c]\x3d";
	b[8] = c & 32 ? "[\x3c]\x3d\uff1c" : "[\x3c\uff1c]\x3d";
	b[9] = c & 32 ? "[\x3e]\x3d\uff1e" : "[\x3e\uff1e]\x3d";
	b[10] = c & 64 ? "" : "[\uff5b]\x3d";
	b[11] = c & 64 ? "" : "[\uff5d]\x3d";
	b[12] = c & 128 ? "[\u3010]\x3d[" : "[\u3010\\[]\x3d";
	b[13] = c & 128 ? "[\u3011]\x3d]" : "[\u3011\\]]\x3d";
	b[14] = c & 256 ? "(.)[\uff1a:]\x3d)$1" : "[\uff1a:\\(\\)]\x3d";
	b[15] = c & 512 ? "\\n\x3d$" : "[\\n\\$]\x3d";
	b[16] = "\\s+\x3d";
	c & 1024 && (b[16] = "\\s{8,}\x3d\u2193", b[17] = "\\s{5,8}\x3d\u2588", b[18] = "\\s{2,5}\x3d\u2585", b[19] = "\\s\x3d\u2582");
	b[20] = "[^0-9a-zA-Z\\u3400-\\uFAD9\\[\\]\\(\\)\\$\\^\\{\\}\\*\\|!\uff5b\uff5d\u02c7\x26\u00a6#@\u00b7\uff0c\u3001\u3002\uff1f\uff01\u300b\u300a\uff1c\uff1e\u201d\u201c\u2018\u2019\uff1b\u2026\u2581\u2582\u2583\u2584\u2585\u2586\u2587\u2588\u2589\u258a\u258b\u258c\u258d\u258e\u258f\u2193\u2192~\ufe19\u250b\u2509\u2014\u3014\u3015%\u26ab\u2b1b\u25bc\u25c6\u2756\u2116\u0398\u039e\u2109\u2295\u30fb\u25e6]\x3d";
	for (var d = 0; d < b.length; d++)
		if (b[d]) {
			var g = b[d].split("\x3d");
			a = a.replace(new RegExp(g[0], "gim"), g[1])
		}
	a = a.replace(/[\$]+\*/g, "*");
	utindex || "*" != a[0] || (a = a.slice(1));
	return a
}, savetxt = function (a, c, b, d) {
	click_error()
}, uptxtfile = function (a, c, b, d) {
	click_error()
};
function getUVAL(a, c) {
	return decodeURIComponent(c ? c : location.search).match(new RegExp(a + "\x3d([^\x26\x3d]+)", "im"))
}
var geturl = function (a, c) {
	var b = {
		"./images/body/text/" : "LiuHeQiangHua,",
		"./images/body/reptxt/" : "0,blue,green,red,",
		"./images/body/images/" : "cesi,DaPinTianXianJue,FoJin,GenYuShengJi,HuangTingJin,LiuHeJinQiang,LiuHeQiangHua,MaChaGunPu,MaJiaChangQiang,ShanHaiJin,TianGongKaiWu,TuiBeiTu,XiYuanLu,",
		"./images/book/" : "data,htxt,name,wtxt3,",
		"./images/book/data/" : "0A,0B,1,2,3,4,5,6,"
	},
	d = {
		"./images/back/bookPicView/" : "0.jpg,1.jpg,10.jpg,100.jpg,101.jpg,102.jpg,103.jpg,104.jpg,105.jpg,106.jpg,107.jpg,108.jpg,109.jpg,11.jpg,12.jpg,13.jpg,14.jpg,15.jpg,16.jpg,17.jpg,18.jpg,19.jpg,2.jpg,20.jpg,21.jpg,22.jpg,23.jpg,24.jpg,25.jpg,26.jpg,27.jpg,28.jpg,29.jpg,3.jpg,30.jpg,31.jpg,32.jpg,33.jpg,34.jpg,35.jpg,36.jpg,37.jpg,38.jpg,39.jpg,4.jpg,40.jpg,41.jpg,42.jpg,43.jpg,44.jpg,45.jpg,46.jpg,47.jpg,48.jpg,49.jpg,5.jpg,50.jpg,51.jpg,52.jpg,53.jpg,54.jpg,55.jpg,56.jpg,57.jpg,58.jpg,59.jpg,6.jpg,60.jpg,61.jpg,62.jpg,63.jpg,64.jpg,65.jpg,66.jpg,67.jpg,68.jpg,69.jpg,7.jpg,70.jpg,71.jpg,72.jpg,73.jpg,74.jpg,75.jpg,76.jpg,77.jpg,78.jpg,79.jpg,8.jpg,80.jpg,81.jpg,82.jpg,83.jpg,84.jpg,85.jpg,86.jpg,87.jpg,88.jpg,89.jpg,9.jpg,90.jpg,91.jpg,92.jpg,93.jpg,94.jpg,95.jpg,96.jpg,97.jpg,98.jpg,99.jpg,",
		"./images/back/mini/" : "ai000.jpg,ai001.jpg,ai002.jpg,ai003.jpg,ai004.jpg,ai005.jpg,ai1.jpg,ai10.jpg,ai2.jpg,ai3.jpg,ai4.jpg,ai5.jpg,ai6.jpg,ai7.jpg,ai8.jpg,ai9.jpg,awl15.jpg,back001.jpg,back003.jpg,back100.jpg,back101.jpg,back102.jpg,back103.jpg,back104.jpg,back105.jpg,back106.jpg,back107.jpg,back108.jpg,back171.jpg,back172.jpg,back173.jpg,back18.jpg,back181.jpg,back182.jpg,back183.jpg,back200.jpg,back201.jpg,back202.jpg,back208.jpg,back209.jpg,back21.jpg,back212.jpg,back213.jpg,back218.jpg,back22.jpg,back220.jpg,back221.jpg,back222.jpg,back226.jpg,back227.jpg,back23.jpg,back230.jpg,back233.jpg,back237.jpg,back24.jpg,back245.jpg,back247.jpg,back249.jpg,back25.jpg,back251.jpg,back254.jpg,back256.jpg,back257.jpg,back261.jpg,back277.jpg,back283.jpg,back285.jpg,back294.jpg,back3.jpg,back304.jpg,back305.jpg,back31.jpg,back314.jpg,back324.jpg,back325.jpg,back328.jpg,back34.jpg,back4.jpg,back41.jpg,back411.jpg,back412.jpg,back413.jpg,back414.jpg,back4141.jpg,back415.jpg,back4151.jpg,back416.jpg,back4161.jpg,back417.jpg,back4171.jpg,back418.jpg,back4181.jpg,back419.jpg,back42.jpg,back420.jpg,back421.jpg,back422.jpg,back423.jpg,back993.jpg,back994.jpg,bg1.jpg,bg2.jpg,bg21.jpg,bg31.jpg,bg41.jpg,bg51.jpg,bg61.jpg,bg71.jpg,bk5.jpg,bk6.jpg,bk7.jpg,bookname.jpg,bookname1.jpg,bookname2.jpg,ceal.jpg,ceal0.jpg,ceal1.jpg,ceal10.jpg,ceal101.jpg,ceal11.jpg,ceal111.jpg,ceal12.jpg,ceal121.jpg,ceal13.jpg,ceal131.jpg,ceal14.jpg,ceal141.jpg,ceal15.jpg,ceal151.jpg,ceal16.jpg,ceal161.jpg,ceal17.jpg,ceal171.jpg,ceal18.jpg,ceal181.jpg,ceal19.jpg,ceal191.jpg,ceal2.jpg,ceal3.jpg,ceal31.jpg,ceal4.jpg,ceal41.jpg,ceal5.jpg,ceal6.jpg,ceal7.jpg,ceal71.jpg,feng.jpg,huo.jpg,long.jpg,mba1.jpg,mba3.jpg,mba4.jpg,mba5.jpg,mba51.jpg,mba61.jpg,mba8.jpg,mba91.jpg,mbfm1.jpg,mbfm10.jpg,mbfm11.jpg,mbfm12.jpg,mbfm13.jpg,mbfm14.jpg,mbfm15.jpg,mbfm16.jpg,mbfm17.jpg,mbfm18.jpg,mbfm181.jpg,mbfm19.jpg,mbfm2.jpg,mbfm3.jpg,mbfm5.jpg,mbfm6.jpg,mbfm61.jpg,mbfm7.jpg,mbfm8.jpg,mbfm9.jpg,md0.jpg,md00.jpg,md01.jpg,md02.jpg,md1.jpg,md11.jpg,md2.jpg,md21.jpg,md3.jpg,md4.jpg,md5.jpg,ms001.jpg,ms002.jpg,ms003.jpg,ms004.jpg,ms005.jpg,null.jpg,page0.jpg,page1.jpg,page10.jpg,page11.jpg,page12.jpg,page13.jpg,page14.jpg,page15.jpg,page16.jpg,page17.jpg,page18.jpg,page19.jpg,page2.jpg,page20.jpg,page21.jpg,page22.jpg,page23.jpg,page24.jpg,page25.jpg,page26.jpg,page27.jpg,page28.jpg,page29.jpg,page3.jpg,page30.jpg,page31.jpg,page32.jpg,page33.jpg,page34.jpg,page35.jpg,page36.jpg,page37.jpg,page38.jpg,page39.jpg,page4.jpg,page40.jpg,page41.jpg,page42.jpg,page43.jpg,page44.jpg,page45.jpg,page46.jpg,page47.jpg,page48.jpg,page49.jpg,page5.jpg,page6.jpg,page7.jpg,page8.jpg,page9.jpg,sbw.jpg,sbw1.jpg,sbw2.jpg,sbw21.jpg,sbw3.jpg,sbw4.jpg,sbw5.jpg,sbw6.jpg,swb101.jpg,swb103.jpg,swb107.jpg,swb123.jpg,swb125.jpg,swb149.jpg,swb162.jpg,swb195.jpg,swb214.jpg,swb219.jpg,swb223.jpg,taobaofmt.jpg,tmimg.jpg,wl10.jpg,wl11.jpg,wl14.jpg,wl27.jpg,wl28.jpg,wl3.jpg,wl30.jpg,wl4.jpg,xb3.jpg,xb4.jpg,xb5.jpg,xb6.jpg,xb7.jpg,zbg1.jpg,zbg2.jpg,zbg3.jpg,zbg4.jpg,zbg5.jpg,zbg51.jpg,"
	};
	if (/subpath=/.test(a)) {
		var g = getUVAL("subpath", a);
		c(b[g[1]])
	} else  / filespath = /.test(a)?(g=getUVAL("filespath",a),c(d[g[1]])):click_error()};
