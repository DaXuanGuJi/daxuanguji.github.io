// JavaScript Document
var bkinfc={
	"豪华封面":'tbackpic@back18.jpg\
			bookpic@#FFFFFF00\
			ptset.bookobj.loads.box.namebox[2][1]@"back202.jpg"\n',
	"蓝皮封面":'tbackpic@\
			bookpic@#344665FF\
			ptset.bookobj.loads.box.namebox[2][1]@"back18.jpg"\n',
	"灰皮封面":'tbackpic@\
			bookpic@#AAA9AAFF\n',
	"黑皮封面":'tbackpic@\
			bookpic@#323232FF\n',
			
	"书名边框_默认深蓝":'ptset.bookobj.loads.box.namebox[2][1]@"back202.jpg"\n',				
	"书名边框_金色豪华质感":'ptset.bookobj.loads.box.namebox[2][1]@"back18.jpg"\n',	
	"书名边框_蓝色磨砂":'ptset.bookobj.loads.box.namebox[2][1]@"ms001.jpg"\n',
	"书名边框_浅蓝色磨砂":'ptset.bookobj.loads.box.namebox[2][1]@"ms002.jpg"\n',
	"书名边框_天蓝色磨砂":'ptset.bookobj.loads.box.namebox[2][1]@"ms005.jpg"\n',
	"书名边框_深绿色磨砂":'ptset.bookobj.loads.box.namebox[2][1]@"ms004.jpg"\n',
	"书名边框_灰色磨砂":'ptset.bookobj.loads.box.namebox[2][1]@"ms003.jpg"\n',

			
	"豪华页面":'bodybk@#FF0000FF\
			bodypic@#FF00FFFF\
			tbodypic@page1.jpg\
			tbodybk@zbg4.png\
			ttxtcel@zbg51.png\
			ptset.bodyobj.bk.tbc@["#f00","#ff0","#00f","#0f0"]\
			ptset.bodyobj.bk.tbt@[["","zbg4.png"],["","zbg4.png"],["","zbg4.png"],["","zbg4.png"]]\
			ptset.bodyobj.pgx.box[1]@"#f00"\
			ptset.bodyobj.pgx.box[2][1]@"back3.jpg"\
			ptset.bodyobj.pgx.loc[4][0]@"#0f0"\
			ptset.bodyobj.pgx.loc[5][1]@"zbg4.png"\
			ptset.bodyobj.wat.atxt.and[4]@"#ff0"\
			ptset.bodyobj.wat.atxt.loc[1]@"#f00"\
			ptset.bodyobj.wat.atxt.loc[2][1]@"zbg2.png"\n',
	"黑白页面":'bodybk@#000000FF\
			bodypic@#FFFFFFFF\
			tbodypic@\
			tbodybk@\
			ttxtcel@\
			ptset.bodyobj.pgx.box[1]@""\
			ptset.bodyobj.pgx.box[2][1]@""\
			ptset.bodyobj.pgx.loc[4][0]@""\
			ptset.bodyobj.pgx.loc[5][1]@""\
			ptset.bodyobj.wat.atxt.and[4]@""\
			ptset.bodyobj.wat.atxt.loc[1]@""\
			ptset.bodyobj.wat.atxt.loc[2][1]@""\n',	
	"封面诗白色":'ptset.bookobj.font.htxt[2]@["#fff"]\n',
	"封面版权白色":'ptset.bookobj.font.copyright[2]@["#fff"]\n',
	"封面诗黑色":'ptset.bookobj.font.htxt[2]@["#000"]\n',
	"封面版权黑色":'ptset.bookobj.font.copyright[2]@["#000"]\n',
	"封面诗红色":'ptset.bookobj.font.htxt[2]@["#f00"]\n',
	"封面版权红色":'ptset.bookobj.font.copyright[2]@["#f00"]\n',
	"封面诗绿色":'ptset.bookobj.font.htxt[2]@["#0f0"]\n',
	"封面版权绿色":'ptset.bookobj.font.copyright[2]@["#0f0"]\n',
	"封面诗蓝色":'ptset.bookobj.font.htxt[2]@["#00f"]\n',
	"封面版权蓝色":'ptset.bookobj.font.copyright[2]@["#00f0"]"\n',
	"封面诗彩色":'ptset.bookobj.font.htxt[2]@["#0f0","#f00","#00f","#50f","#f00","#00f"]\n',
	"封面版权彩色":'ptset.bookobj.font.copyright[2]@["#0f0","#0f0","#00f","#f00","#f06","#0ff"]\n',
	"白色封面缝线":'ptset.bookobj.box.imagebox2[1]@"#fff"\
			ptset.bookobj.box.imagebox3[1]@"#fff"\
			ptset.bookobj.box.imagebox4[1]@"#fff"\
			ptset.bookobj.box.imagebox5[1]@"#fff"\
			ptset.bookobj.box.imagebox6[1]@"#fff"\
			ptset.bookobj.box.imagebox7[1]@"#fff"\
			ptset.bookobj.box.imagebox8[1]@"#fff"\
			ptset.bookobj.box.imagebox9[1]@"#fff"\n',
	"红色封面缝线":'ptset.bookobj.box.imagebox2[1]@"#f00"\
			ptset.bookobj.box.imagebox3[1]@"#f00"\
			ptset.bookobj.box.imagebox4[1]@"#f00"\
			ptset.bookobj.box.imagebox5[1]@"#f00"\
			ptset.bookobj.box.imagebox6[1]@"#f00"\
			ptset.bookobj.box.imagebox7[1]@"#f00"\
			ptset.bookobj.box.imagebox8[1]@"#f00"\
			ptset.bookobj.box.imagebox9[1]@"#f00"\n',
	"黑色封面缝线":'ptset.bookobj.box.imagebox2[1]@"#000"\
			ptset.bookobj.box.imagebox3[1]@"#000"\
			ptset.bookobj.box.imagebox4[1]@"#000"\
			ptset.bookobj.box.imagebox5[1]@"#000"\
			ptset.bookobj.box.imagebox6[1]@"#000"\
			ptset.bookobj.box.imagebox7[1]@"#000"\
			ptset.bookobj.box.imagebox8[1]@"#000"\
			ptset.bookobj.box.imagebox9[1]@"#000"\n',
	"黄色封面缝线":'ptset.bookobj.box.imagebox2[1]@"#ff0"\
			ptset.bookobj.box.imagebox3[1]@"#ff0"\
			ptset.bookobj.box.imagebox4[1]@"#ff0"\
			ptset.bookobj.box.imagebox5[1]@"#ff0"\
			ptset.bookobj.box.imagebox6[1]@"#ff0"\
			ptset.bookobj.box.imagebox7[1]@"#ff0"\
			ptset.bookobj.box.imagebox8[1]@"#ff0"\
			ptset.bookobj.box.imagebox9[1]@"#ff0"\n',
	"默认书名边框":'ptset.bookobj.loads.box.namebox@[[36,30,42,170],"",["xp","back18.jpg"]]\
			ptset.bookobj.loads.text.name[0]@[2,2,2,46,2,2]\
			ptset.bookobj.loads.text.name[3][0]@"#fff"\
			ptset.bookobj.loads.text.author[3][0]@"#0f0"\n',
	"木纹书名边框":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#fff",["s","bk7.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.author[3][0]@""\n',
	"木纹书名边框加花纹":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#fff",["s","bk6.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.author[3][0]@""\n',
	"白色书名边框":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#fff",["s","bookname1.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.author[3][0]@""\n',
	"黑色书名边框":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#000",["s","bookname2.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.name[5]@["#ffff","#0000",0]\
			ptset.bookobj.loads.text.author[3][0]@""\n',
	"白色书名边框默认字体":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#fff",["s","bookname1.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[2]@""\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.name[5]@["#000f","#0000",4]\
			ptset.bookobj.loads.text.author[2]@""\
			ptset.bookobj.loads.text.author[3][0]@"#000"\
			ptset.bookobj.loads.text.author[5]@["#000f","#0000",4]\
			ptset.bookobj.font.name[2]@["#000"]\
			ptset.bookobj.loads.box.authorbox[0]@[40.5,154,33,16]\n',
	"黑色书名边框默认字体":'ptset.bookobj.loads.box.namebox@[[36,30,42,180],"#000",["s","bookname2.png"]]\
			ptset.bookobj.loads.text.name[0]@[2,10,2,56,2,2]\
			ptset.bookobj.loads.text.name[2]@""\
			ptset.bookobj.loads.text.name[3][0]@""\
			ptset.bookobj.loads.text.name[5]@["#ffff","#0000",4]\
			ptset.bookobj.loads.text.author[2]@""\
			ptset.bookobj.loads.text.author[3][0]@"#000"\
			ptset.bookobj.loads.text.author[5]@["#ffff","#0000",4]\
			ptset.bookobj.font.name[2]@["#fff"]\
			ptset.bookobj.loads.box.authorbox[0]@[40.5,154,33,16]\n',
	"背景图_蓝色科技":'tbackpic@mba1.png\n',
	"背景图_蓝色拉丝":'tbackpic@mba4.png\n',
	"背景图_蓝色方格":'tbackpic@mba8.png\n',
	"背景图_蓝色简约":'tbackpic@back993.png\n',
	"背景图_蓝色迷宫":'tbackpic@back42.jpg\n',
	"背景图_蓝色三角":'tbackpic@back994.png\n',		
	"背景图_红色花中":'tbackpic@mba3.png\n',
	"背景图_黑色拉丝r":'tbackpic@mba51.png\n',
	"背景图_黑色拉丝l":'tbackpic@mba5.png\n',
	"背景图_橙色树叶":'tbackpic@back003.png\n',
	"背景图_紫色简约":'tbackpic@back41.jpg\n',	
	"背景图_蓝色磨砂":'tbackpic@ms001.jpg\n',
	"背景图_浅蓝色磨砂":'tbackpic@ms002.jpg\n',
	"背景图_天蓝色磨砂":'tbackpic@ms005.jpg\n',
	"背景图_深绿色磨砂":'tbackpic@ms004.jpg\n',
	"背景图_灰色磨砂":'tbackpic@ms003.jpg\n',
	"背景图_黄色花藤":'tbackpic@back328.jpg\n',
	"背景图_黄色花藤加强":'tbackpic@back325.jpg\n',	
	"背景方图_黄背景白云朵":'tbackpic@sbw4.png\
			ptset.backimage[0]@""\n',
	"背景方图_龙纹线条":'tbackpic@sbw5.png\
			ptset.backimage[0]@""\n',		
	"背景方图_黄色透明祥云":'tbackpic@mba61.png\
			ptset.backimage[0]@"s"\n',
	"背景方图_灰色透明扇子":'tbackpic@mba91.png\
			ptset.backimage[0]@"s"\n',	
	"背景方图_蓝色透明火焰":'tbackpic@sbw1.png\
			ptset.backimage[0]@""\n',
	"背景方图_灰色透明海浪":'tbackpic@sbw.png\
			ptset.backimage[0]@""\n',
	"背景方图_红色透明云浪":'tbackpic@sbw3.png\
			ptset.backimage[0]@""\n',		
	"背景方图_黄灰色透明拼图":'tbackpic@sbw2.png\
			ptset.backimage[0]@""\n',
	"背景方图_黄灰色透明小拼图":'tbackpic@sbw21.png\
			ptset.backimage[0]@""\n',
	"背景方图_红蓝灰色透明三角拼图":'tbackpic@sbw6.png\
			ptset.backimage[0]@""\n',					
	"封面图_蓝色科技":'tbookpic@mba1.png\n',
	"封面图_蓝色拉丝":'tbookpic@mba4.png\n',
	"封面图_蓝色方格":'tbookpic@mba8.png\n',
	"封面图_蓝色简约":'tbookpic@back993.png\n',
	"封面图_蓝色三角":'tbookpic@back994.png\n',
	"封面图_蓝色迷宫":'tbookpic@back42.jpg\n',
	"封面图_红色花中":'tbookpic@mba3.png\n',
	"封面图_黑色拉丝r":'tbookpic@mba51.png\n',
	"封面图_黑色拉丝l":'tbookpic@mba5.png\n',
	"封面图_橙色树叶":'tbookpic@back003.png\n',
	"封面图_紫色简约":'tbookpic@back41.jpg\n',
	"封面图_蓝色磨砂":'tbookpic@ms001.jpg\n',
	"封面图_浅蓝色磨砂":'tbookpic@ms002.jpg\n',
	"封面图_天蓝色磨砂":'tbookpic@ms005.jpg\n',
	"封面图_深绿色磨砂":'tbookpic@ms004.jpg\n',
	"封面图_灰色磨砂":'tbookpic@ms003.jpg\n',
	"封面图_黄色花藤":'tbookpic@back328.jpg\n',
	"封面图_黄色花藤加强":'tbookpic@back325.jpg\n',
	"封面方图_黄背景白云朵":'tbookpic@sbw4.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',
	"封面方图_龙纹线条":'tbookpic@sbw5.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',	
	"封面方图_黄色透明祥云":'tbookpic@mba61.png\
			ptset.bookobj.bkpic[1][0]@"s"\n',
	"封面方图_灰色透明扇子":'tbookpic@mba91.png\
			ptset.bookobj.bkpic[1][0]@"s"\n',
	"封面方图_蓝色透明火焰":'tbookpic@sbw1.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',
	"封面方图_黄灰色透明拼图":'tbookpic@sbw2.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',
	"封面方图_黄灰色透明小拼图":'tbookpic@sbw21.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',			
	"封面方图_红蓝灰色透明三角拼图":'tbookpic@sbw6.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',
	"封面方图_灰色透明海浪":'tbookpic@sbw.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',
	"封面方图_红色透明云浪":'tbookpic@sbw3.png\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\
			ptset.bookobj.bkpic[1][0]@""\n',					
	"半封面图_红色幻彩":'tbookpic@mbfm5.png\n',
	"半封面图_紫色简约":'tbookpic@back4.jpg\n',
	"半封面图_黑色简约":'tbookpic@mbfm3.png\n',
	"半封面图_黑色三角":'tbookpic@mbfm1.png\n',
	"半封面图_黄色三角":'tbookpic@bk5.png\n',
	"半封面图_蓝色六边形":'tbookpic@mbfm7.png\n',
	"半封面图_黄色透明祥云":'tbookpic@mbfm6.png\n',
	"半封面图_黄色半透明祥云":'tbookpic@mbfm61.png\n',
	"半封面图_灰色透明扇子":'tbookpic@mbfm9.png\n',
	"半封面图_蓝色透明水波纹":'tbookpic@mbfm8.png\n',
	"半封面图_黄色透明龙":'tbookpic@mbfm10.png\n',
	"半封面图_红色透明龙":'tbookpic@mbfm11.png\n',
	"半封面图_蓝色透明龙":'tbookpic@mbfm12.png\n',
	"半封面图_绿色透明龙":'tbookpic@mbfm13.png\n',
	"半封面图_红色剪纸凤凰飞":'tbookpic@mbfm14.png\n',
	"半封面图_红色剪纸凤凰鸣":'tbookpic@mbfm15.png\n',
	"半封面图_黄色透明凤凰俯冲":'tbookpic@mbfm16.png\n',
	"半封面图_七彩透明凤凰展翅":'tbookpic@mbfm17.png\n',
	"半封面图_七彩透明凤凰仰飞":'tbookpic@mbfm18.png\n',
	"半封面图_七彩透明凤凰仰飞线条":'tbookpic@mbfm181.png\n',
	"半封面图_七彩透明凤凰腾飞":'tbookpic@mbfm19.png\n',
	"页面纸张_豪华古纸":'tbodypic@page1.jpg\n',
	"页面纸张_花纹深黄":'tbodypic@page3.jpg\n',
	"页面纸张_花纹浅黄":'tbodypic@page2.jpg\n',
	"全置封面图页面平铺":'ptset.bookobj.bkpic[1][0]@""\
			ptset.bookobj.bkpic[0]@[0,0,-1,-1,0,0,0,0]\n',
	"全置封面图宽度比例缩放":'ptset.bookobj.bkpic[1][0]@"x"\
			ptset.bookobj.bkpic[0]@[0,0,-1,0,0,0,0,0]\n',
	"全置封面图高度比例缩放":'ptset.bookobj.bkpic[1][0]@"y"\
			ptset.bookobj.bkpic[0]@[0,0,0,-1,0,0,0,0]\n',	
	"全置封面图页面缩放":'ptset.bookobj.bkpic[1][0]@"s"\
			ptset.bookobj.bkpic[0]@[0,0,0,0,0,0,0,0]\n',
	"左置缩放封面图":'ptset.bookobj.bkpic[1][0]@"s"\
			ptset.bookobj.bkpic[0]@[0,0,0,0,0,0,ptset.page[ptset.page.info].w-ptobj.bookobj.fengx/2,ptset.page[ptset.page.info].h]\n',
	"右置缩放封面图":'ptset.bookobj.bkpic[1][0]@"s"\
		ptset.bookobj.bkpic[0]@[0,0,0,0,ptset.page[ptset.page.info].w+ptset.bookobj.fengx/2+ptset.bookobj.height[0],0,ptset.page[ptset.page.info].w-ptobj.bookobj.fengx/2,ptset.page[ptset.page.info].h]\n',
	"缝线花纹图":'ptset.bookobj.box.imagebox0[2]@["s","back414.png"]\n',
	"缝线花纹图加缝线":'ptset.bookobj.box.imagebox0[2]@["s","back4141.png"]\n',
	"缝线牡丹图":'ptset.bookobj.box.imagebox0[2]@["s","back415.png"]\n',
	"缝线图牡丹加缝线":'ptset.bookobj.box.imagebox0[2]@["s","back4151.png"]\n',
	"缝线花边图":'ptset.bookobj.box.imagebox0[2]@["s","back416.png"]\n',
	"缝线花边图加缝线":'ptset.bookobj.box.imagebox0[2]@["s","back4161.png"]\n',
	"缝线祥云图黄":'ptset.bookobj.box.imagebox0[2]@["s","back417.png"]\n',
	"缝线祥云图黄加缝线":'ptset.bookobj.box.imagebox0[2]@["s","back4171.png"]\n',
	"缝线祥云图黑":'ptset.bookobj.box.imagebox0[2]@["s","back418.png"]\n',
	"缝线祥云图黑加缝线":'ptset.bookobj.box.imagebox0[2]@["s","back4181.png"]\n',
	"版权图_黄色磨砂":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg31.png"]\n',
	"版权图_黄色祥云":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg21.png"]\n',
	"版权图_红色金祥云":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg41.png"]\n',
	"版权图_红色白祥云":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg51.png"]\n',
	"版权图_金色龙浮雕":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg61.png"]\n',
	"版权图_默认绚彩":'ptset.bookobj.loads.box.copyrightbox[2]@["s","bg1.png"]\n',
	"页面字列图_紫色花左":'ptset.bodyobj.col.tlt[1][1]@"back251.png"\n',
	"页面字列图_紫色花右":'ptset.bodyobj.col.tlt[1][1]@"back261.png"\n',
}

var viewfg=document.createElement("select");
viewfg.options.add(new Option("操作","0"));
/*viewfg.options.add(new Option("保存当前设定为封面id模板","1"));
viewfg.options.add(new Option("删除封面id模板","2"));
viewfg.options.add(new Option("生成封面id缩略图","3"));*/
viewfg.options.add(new Option("查看封面id缩略图","4"));
viewfg.style.width="50px";
viewfg.onchange  = function (e) {
	/*if(this.value=="1")addview();
	if(this.value=="2")addview(1);
	if(this.value=="3")picview();*/
	if(this.value=="4"){
		geturl ("filespath="+oldpath+ptobj.backpath+"bookPicView/",function(ret) {
				selfgimgck({path: oldpath+ptobj.backpath+"bookPicView/", txt:ret.split(",")},0)
		});
	}
	this.value="0";
	}
ffid.firstElementChild.firstElementChild.insertBefore(viewfg,tbodyht.nextSibling);
var addview= function (idx) {
		var taobaoindex=0;
		var ida=Object.keys(booksetlist).length;
		try{taobaoindex = localStorage ? localStorage.taobaoindex ?parseInt(localStorage.taobaoindex): 0 : 0;	}catch(e){}
	if(!idx){
		for(var i in booksetlist){
			//console.log([booksetlist[i][2][0],ptset.bookobj.bkpic[1][1]])
			if(ptset.bookobj.bkpic[1][1]&&booksetlist[i][2][0]==ptset.bookobj.bkpic[1][1]){
				if(!confirm('封面背景图片'+ptset.bookobj.bkpic[1][1]+"已存在,是否继续保存？\n存在封面id:["+i+"]")){
					return;
				}
			}
		}	
		var zarr=[];
		for (var k = 0; k <wlst.length; k++) {
			zarr.push([]);		
				for (var m = 0; m <wlst[k].length; m++) {				
					if(wlst[k][m][5]=="."){	
						eval("var tmp="+wlst[k][m]+";")	
						if("string"===typeof tmp)	
						zarr[k].push(tmp);
						else zarr[k].push(JSON.stringify(tmp));
					}
					else{
						if(wlst[k][m]=="qrcolor"||wlst[k][m]=="brcolor")zarr[k].push(document.getElementById(wlst[k][m]).value);
						if(wlst[k][m]=="缝线颜色只能排在最后")zarr[k].push([ptset.bookobj.box.imagebox2[1],ptset.bookobj.box.imagebox4[1]]);
					}
					
				}				 		
		}
		var b=prompt('请输入保存的封面id!\n当前封面id:'+taobaoindex+"\n总共封面id:"+(ida-1),ida);if(!b)return;
		if(!/^[\d]+$/.test(b)){alert("输入错误！");return;}
		booksetlist["id"+b]=zarr;
	}
	else{
		var b=prompt('请输入删除封面id!\n当前封面id:'+taobaoindex+"\n总共封面id:"+(ida-1)+"\n可用连字符-。如100-110",ida);if(!b)return;
		if(!/^[\d\-]+$/.test(b)){alert("输入错误！");return;}
		var cc=b.split("-");
		if(cc.length>1){
			cc[0]=parseInt(cc[0]);
			cc[1]=parseInt(cc[1]);
			for (var m = cc[0]; m <=cc[1]; m++) {
				booksetlist["id"+m]=null;
			}
		}
		else
		booksetlist["id"+b]=null;
	}
	ida=Object.keys(booksetlist).length-1;
	var newbkset={};
	for(var i=ida;i>=0;i--){
		if(booksetlist["id"+i])newbkset["id"+i]=booksetlist["id"+i];
	}	
	var tph=imgmu()+"js/autoset.js";
	var jsx=("var booksetlist ="+JSON.stringify(newbkset)).replace(/\\"/g,"'");
			savetxt(encodeURIComponent(jsx),tph,function (ret){
			message ("提示","当前页面文件为:<br/>"+ret,10);		
			},1);
}
var picview= function (e) {
	var taobaoindex=0;
	try{taobaoindex = localStorage ? localStorage.taobaoindex ?parseInt(localStorage.taobaoindex): 0 : 0;	}catch(e){}	
	var b=prompt('请输入封面id和张数\n0张为生成开始id到最后的全部id预览图!',taobaoindex+',1');if(!b)return;
	if(!/^[\d,]+$/.test(b)){alert("输入错误！");return;}
	var vl=eval("["+b+"]");
	picview_bat[0]=1;
	picview_bat[1]=vl[1]?vl[1]:Object.keys(booksetlist).length-1;
	tbodyrand.value="2";
	upchang(tbodyrand);
	book3dk.innerHTML="🔲";
	if("undefined"===typeof ptset.bookobj.box.taobaofm){
	ptset.bookobj.box.taobaofm=[[-10,"H-d[3]",40,40],"",["s","ceal31.png"]];
	}
	taobao_fg(vl[0]);
	MCk(ptbook);
}
var selfg=document.createElement("select");
selfg.options.add(new Option("风格",""));
selfg.style.width="80px";
selfg.id="bookinfset";
var arr = Object.entries(bkinfc)
for (var i in arr) {
	selfg.options.add(new Option(arr[i][0], arr[i][0]));
}
selfg.onchange  = function (e) {
		if(this.value)conftxt("[config]\n"+bkinfc[this.value].replace(/[\r|\n|\t]+/g,"\n")+"[config]");
	}
ffid.firstElementChild.firstElementChild.insertBefore(selfg,tbodyht.nextSibling);

var selfgimgck=function(ret,flg){
	ret.txt.sort(function(a,b){
		return b-a;
	});
	var midx=0;
	var smu=["s","xs","ys","n","","x","y"];
	var mu=["缩放到页面宽高","以宽度缩放","以高度缩放","不缩放","宽高平铺","宽度平铺","高度平铺"];
	var nidx=0;
	var fmu=[];
	fmu.push([0,0,0,0,0,0,0,0]);
	fmu.push([0,0,0,0,0,0,ptset.page[ptset.page.info].w-ptobj.bookobj.fengx/2,ptset.page[ptset.page.info].h]);
	fmu.push([0,0,0,0,ptset.page[ptset.page.info].w+ptset.bookobj.fengx/2+ptset.bookobj.height[0],0,ptset.page[ptset.page.info].w-ptobj.bookobj.fengx/2,ptset.page[ptset.page.info].h]);	
	var nu=["封面缩放全置","封面缩放左置","封面缩放右置"];	
	var index=0;
	if(ByID("docg"))document.body.removeChild(ByID("docg"));
	var tg = document.createElement('div');
	tg.style.width = "340px";
	tg.style.maxHeight ="100%";
	tg.style.overflowY="auto";
	tg.style.top =0;
	tg.style.left = "calc(100vw - 340px)";
	tg.style.padding = '0 5px 0 5px';
	tg.style.color = '#00f';
	tg.style.backgroundColor = '#0ff';
	tg.style.position = "fixed";
	tg.style.zIndex = 112;
	tg.style.fontSize="16px";
	tg.innerHTML = '<p style="width:305px;position: fixed;cursor:default;text-align:right;"><b id="docgpre">⏫</b><b id="docgnext">⏬</b><b style="background-color:#FF0;"> 总计: <span>'+ret.txt.length+'</span> 加载: <span id="boxindex">'+index+'</span><strong style="background-color:#FF0;cursor:default;">❎</strong></b></p>';
	tg.id="docg";			
	document.body.appendChild(tg);
	ByID("docgpre").onclick=ByID("docgnext").onclick=function (e){
		ByID("docg").scrollTop+=this.id=="docgnext"?900:(-900);
		var evt = document.createEvent('MouseEvents');
		evt.initEvent('scroll', true, true);
		ByID("docg").dispatchEvent(evt);	
	}
	var lod= function () {
		if(index>=ret.txt.length){return;}
		var edx=index+10;
		for (var k =index;k<ret.txt.length; k++) {
			if(k==edx)break;
			var dv=document.createElement("div");
			dv.className="btn_left";
			var im = new Image();
			im.src =upurl(wpyt.value + "?img=" +ret.path+ret.txt[k]);
			im.title=ret.txt[k];
			im.alt=k;
			im.setAttribute("crossOrigin","anonymous");			
			var sv=document.createElement("span");
			sv.style.marginBottom = '5px';									
			sv.appendChild(document.createTextNode("⚙"));
			dv.appendChild(sv);
				if(flg){
				var sv=document.createElement("span");
				sv.style.marginBottom = '5px';									
				sv.appendChild(document.createTextNode("背景"));
				dv.appendChild(sv);
				sv=document.createElement("span");
				sv.style.marginBottom = '5px';
				sv.appendChild(document.createTextNode("封面"));
				dv.appendChild(sv);
				sv=document.createElement("span");
				sv.style.marginBottom = '5px';
				sv.appendChild(document.createTextNode("页面"));
				dv.appendChild(sv);
				dv.appendChild(document.createElement("hr"));
			}
			else{
				sv=document.createElement("span");
				sv.style.marginBottom = '5px';
				sv.appendChild(document.createTextNode("🔲"));
				sv.title="让上面设置缩放覆盖封面id的设定";
				dv.insertBefore(sv,dv.firstChild);

				sv=document.createElement("span");
				sv.style.marginBottom = '5px';
				sv.appendChild(document.createTextNode("ID："+ret.txt[k]));
				dv.appendChild(sv);
				dv.appendChild(document.createElement("hr"));

				
			}
			dv.appendChild(im);
			tg.appendChild(dv);
			index++;
		}
		document.getElementById("boxindex").innerHTML=index;
	}
	lod();
	tg.onscroll = function (e) {
		e.stopPropagation();
			if(tg.clientHeight+tg.scrollTop>tg.scrollHeight-10){
				if(ret.txt.length>index)lod();
			}		
	}
	tg.onmousemove = function (e) {
		e.stopPropagation();
		 if (e.target.tagName == "IMG") {
			e.target.style.backgroundColor = '#f00';
			e.target.style.cursor = "default";
			e.target.onmouseout = function (e) {
				this.style.backgroundColor = tg.style.backgroundColor;
			}
		}
		else if (e.target.tagName=="SPAN") {
			e.target.style.color = '#FFF';
			e.target.style.backgroundColor = '#F00';
			e.target.onmouseout = function (e) {
				this.style.backgroundColor = tg.style.backgroundColor;
				this.style.color = tg.style.color;
			}
			return false;	
		}
	}	
	tg.onclick = function (e) {
		if(e.target.name=="imst"){
				if(ByID("simg")){
					var ck=document.getElementsByName("imst");				
					for(var i=0;i<ck.length;i++){if(ck[i].checked){midx=i;break;}}
					if(midx!==0){document.getElementsByName("inst")[0].checked=true;nidx=0}
				}	
						
			}
		if(e.target.name=="inst"){
				midx=0;document.getElementsByName("imst")[0].checked=true;
				if(ByID("simg")){
					var ck=document.getElementsByName("inst");				
					for(var i=0;i<ck.length;i++){if(ck[i].checked){nidx=i;break;}}
				}	
						
			}
		e.stopPropagation();

		if (e.target.innerHTML=="❎") {
			document.body.removeChild(ByID("docg"));
			return false;	
		}			
		else if (e.target.tagName == "IMG") {
			if(e.target.src.indexOf("bookPicView")>0){
				var htx=e.target.src.match(/(\d+)\.jpg/)[1];
				if(confirm('是否加载封面ID：'+htx+'设定封面???')){
					taobao_fg(htx);
					if(e.target.parentNode.firstChild.innerHTML=="☑️"){
						ptset.bookobj.bkpic[1][0]=smu[midx];
						ptset.bookobj.bkpic[0]=fmu[nidx];		
						if(midx==4)ptset.bookobj.bkpic[0]=[0,0,-1,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
						if(midx==5)ptset.bookobj.bkpic[0]=[0,0,-1,0,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
						if(midx==6)ptset.bookobj.bkpic[0]=[0,0,0,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
					}
					
					setTimeout(function () {
						var evt = document.createEvent('MouseEvents');
						evt.initEvent('click', false, true);
						ptbook.dispatchEvent(evt);
					},1000)
				}				
			}
			return false;	
		}
		else if (e.target.tagName=="SPAN") {
				var imgobj=e.target.parentNode.lastElementChild;
				var htx=decodeURI(imgobj.src).match(/([^\\\/]+\.[svjpng]{3})/);
				htx=htx?htx[1]:"";
								
			if(e.target.innerHTML=="背景"){							
				if(htx&&confirm('修改背景图为'+htx+'??')){
				tbackpic.value=htx;
				upchang(tbackpic);
				ptset.backimage[0]=smu[midx];
				if(confirm('修改背景图片已设为'+htx+'是否重载???')){
					setTimeout(function () {
						var evt = document.createEvent('MouseEvents');
						evt.initEvent('click', false, true);
						ptbook.dispatchEvent(evt);
					},1000);
				}
				}
			}
			if(e.target.innerHTML=="封面"){
				if(htx&&confirm('修改封面图为'+htx+'??')){
				tbookpic.value=htx;
				upchang(tbookpic);
				ptset.bookobj.bkpic[1][0]=smu[midx];
				ptset.bookobj.bkpic[0]=fmu[nidx];		
				if(midx==4)ptset.bookobj.bkpic[0]=[0,0,-1,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
				if(midx==5)ptset.bookobj.bkpic[0]=[0,0,-1,0,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
				if(midx==6)ptset.bookobj.bkpic[0]=[0,0,0,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
				if(confirm('修改封面图片已设为'+htx+'是否重载???')){
					setTimeout(function () {
						var evt = document.createEvent('MouseEvents');
						evt.initEvent('click', false, true);
						ptbook.dispatchEvent(evt);
					},1000);
				}
				
				}
			}
			if(e.target.innerHTML=="页面"){
				if(htx){
				tbodypic.value=htx;
				upchang(tbodypic);
				ptset.bodyobj.bkpic[1][0]=smu[midx];
				if(midx==4)ptset.bodyobj.bkpic[0]=[0,0,-1,-1,0,0,0,0];
				if(midx==5)ptset.bodyobj.bkpic[0]=[0,0,-1,0,0,0,0,0];
				if(midx==3)ptset.bodyobj.bkpic[0]=[0,0,0,-1,0,0,0,0];
				if(confirm('修改页面图片已设为'+htx+'是否重载???')){
					setTimeout(function () {
						var evt = document.createEvent('MouseEvents');
						evt.initEvent('click', false, true);
						ptbody.dispatchEvent(evt);
					},1000);
				}
				
				}
			}			
			if(e.target.innerHTML[0]=="I"&&e.target.innerHTML[1]=="D"){
				htx=e.target.innerHTML.match(/\d+/)[0];
				if(confirm('是否加载封面ID：'+htx+'设定封面???')){
					taobao_fg(htx);
					if(e.target.parentNode.firstChild.innerHTML=="☑️"){
						ptset.bookobj.bkpic[1][0]=smu[midx];
						ptset.bookobj.bkpic[0]=fmu[nidx];		
						if(midx==4)ptset.bookobj.bkpic[0]=[0,0,-1,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
						if(midx==5)ptset.bookobj.bkpic[0]=[0,0,-1,0,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
						if(midx==6)ptset.bookobj.bkpic[0]=[0,0,0,-1,fmu[nidx][4],fmu[nidx][5],fmu[nidx][6],fmu[nidx][7]];
					}
					if(confirm('是否开始生成封面???')){
						setTimeout(function () {
							var evt = document.createEvent('MouseEvents');
							evt.initEvent('click', false, true);
							ptbook.dispatchEvent(evt);
						},1000)
					}
				}
			}
			if(e.target.innerHTML=="🔲"||e.target.innerHTML=="☑️"){
				e.target.innerHTML=e.target.innerHTML=="☑️"?"🔲":"☑️"
			}				
			if(e.target.innerHTML=="⚙"||e.target.innerHTML=="❌"){
				if(imgobj.style.display!=="none"){
					if(ByID("simg")){
						ByID("simg").nextElementSibling.style.display="block";
						ByID("simg").outerHTML="";
					}	
				var dv=document.createElement("div");
				dv.style.verticalAlign="middle";
				dv.style.textAlign="left";
				dv.id="simg";
				dv.style.height=(imgobj.parentNode.offsetHeight-2)+"px";
				var txt="";
				for (var k =0;k<mu.length; k++) {
					var kd=midx==k?" checked":"";
					txt+='<hr/><p><input name="imst" type="radio"'+kd+'>'+mu[k]+'</p>';
				}
				for (var k =0;k<nu.length; k++) {
					var kd=nidx==k?" checked":"";
					txt+='<hr/><p><input name="inst" type="radio"'+kd+'>'+nu[k]+'</p>';
				}
				
				
				dv.innerHTML =txt+'<hr/><span style="background-color:#0FF;cursor:default;">❌</span>'+imgobj.alt;
				imgobj.style.display="none";
				e.target.parentNode.insertBefore(dv,imgobj);
				}
				else{
					imgobj.style.display="block";
					e.target.parentNode.removeChild(imgobj.previousElementSibling);
				}

			}			
			return false;	
		}
	}
}
var selfgimg=document.createElement("input");	
selfgimg.type="button";
selfgimg.value="风格预览";
selfgimg.onclick = function (e) {
	geturl ("filespath="+oldpath+ptobj.backpath+"mini/",function(ret) {
			selfgimgck({path: oldpath+ptobj.backpath+"mini/", txt:ret.split(",")},1)
	});
}
ffid.firstElementChild.firstElementChild.insertBefore(selfgimg,tbodyht.nextSibling);